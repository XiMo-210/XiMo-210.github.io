
<!DOCTYPE html><html lang="zh-CN">

<head>
  <meta charset="utf-8">
  <meta name="hexo-theme" content="https://github.com/xaoxuu/hexo-theme-stellar/tree/1.29.1" theme-name="Stellar" theme-version="1.29.1">
  
  <meta name="generator" content="Hexo 7.3.0">
  <meta http-equiv='x-dns-prefetch-control' content='on' />
  <link rel="preconnect" href="https://gcore.jsdelivr.net" crossorigin><link rel="preconnect" href="https://unpkg.com" crossorigin><link rel="preconnect" href="https://cdn.bootcdn.net" crossorigin>
  <meta name="renderer" content="webkit">
  <meta name="force-rendering" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
  <meta name="HandheldFriendly" content="True" >
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#000">
  <meta name="theme-color" content="#f9fafb">
  
  <title>Gin 简易教程 - 惜寞的无人小间</title>

  
    <meta name="description" content="精弘网络 2023 暑期后端 Go Web 开发基础课程 —— Gin 框架">
<meta property="og:type" content="article">
<meta property="og:title" content="Gin 简易教程">
<meta property="og:url" content="https://lonesome.cn/posts/gin-simple-tutorial/index.html">
<meta property="og:site_name" content="惜寞的无人小间">
<meta property="og:description" content="精弘网络 2023 暑期后端 Go Web 开发基础课程 —— Gin 框架">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://img.lonesome.cn/blog/go-web/Nyw4d2eA.webp">
<meta property="og:image" content="https://img.lonesome.cn/blog/go-web/Nyw4d2eA.webp">
<meta property="og:image" content="https://img.lonesome.cn/blog/go-web/fksrMZry.webp">
<meta property="og:image" content="https://img.lonesome.cn/blog/go-web/IsmjGIUz.webp">
<meta property="og:image" content="https://img.lonesome.cn/blog/go-web/1yu5vlul.webp">
<meta property="og:image" content="https://img.lonesome.cn/blog/go-web/0866b73a-4d10-4d7d-adcf-7ac6c9483a4f.webp">
<meta property="article:published_time" content="2023-08-13T01:30:00.000Z">
<meta property="article:modified_time" content="2024-08-11T12:53:23.545Z">
<meta property="article:author" content="惜寞">
<meta property="article:tag" content="Go">
<meta property="article:tag" content="Gin">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://img.lonesome.cn/blog/go-web/Nyw4d2eA.webp">
  
  
  
  <meta name="keywords" content="Go,Gin">

  <!-- feed -->
  
    <link rel="alternate" href="/atom.xml" title="惜寞的无人小间" type="application/atom+xml">
  

  <link rel="stylesheet" href="/css/main.css?v=1.29.1">

  
    <link rel="shortcut icon" href="/assets/favicon.png">
  

  

  <link rel="stylesheet" href="https://cdn.bootcdn.net/ajax/libs/lxgw-wenkai-screen-webfont/1.7.0/style.min.css" media="all" />
</head>
<body>

<div class="l_body s:aa content tech" id="start" layout="post" ><aside class="l_left"><div class="leftbar-container">


<header class="header"><div class="logo-wrap"><div class="icon"><img no-lazy class="icon" src="/assets/avatar.png" onerror="javascript:this.classList.add('error');this.src='https://gcore.jsdelivr.net/gh/cdn-x/placeholder@1.0.12/image/2659360.svg';"></div><a class="title" href="/"><div class="main" ff="title">惜寞</div><div class="sub normal cap">无人小间</div><div class="sub hover cap" style="opacity:0"> An unoccupied room</div></a></div></header>

<div class="nav-area">
<div class="search-wrapper" id="search-wrapper"><form class="search-form"><a class="search-button" onclick="document.getElementById(&quot;search-input&quot;).focus();"><svg t="1705074644177" viewBox="0 0 1025 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1560" width="200" height="200"><path d="M1008.839137 935.96571L792.364903 719.491476a56.783488 56.783488 0 0 0-80.152866 0 358.53545 358.53545 0 1 1 100.857314-335.166073 362.840335 362.840335 0 0 1-3.689902 170.145468 51.248635 51.248635 0 1 0 99.217358 26.444296 462.057693 462.057693 0 1 0-158.255785 242.303546l185.930047 185.725053a51.248635 51.248635 0 0 0 72.568068 0 51.248635 51.248635 0 0 0 0-72.978056z" p-id="1561"></path><path d="M616.479587 615.969233a50.428657 50.428657 0 0 0-61.498362-5.534852 174.655348 174.655348 0 0 1-177.525271 3.484907 49.403684 49.403684 0 0 0-58.833433 6.76482l-3.074918 2.869923a49.403684 49.403684 0 0 0 8.609771 78.10292 277.767601 277.767601 0 0 0 286.992355-5.739847 49.403684 49.403684 0 0 0 8.404776-76.667958z" p-id="1562"></path></svg></a><input type="text" class="search-input" id="search-input" placeholder="站内搜索"></form><div id="search-result"></div><div class="search-no-result">没有找到内容！</div></div>


<nav class="menu dis-select"><a class="nav-item active" title="博客" href="/"><span>博客</span></a><a class="nav-item" title="专栏" href="/topic/"><span>专栏</span></a><a class="nav-item" title="友链" href="/friends/"><span>友链</span></a><a class="nav-item" title="关于" href="/about/"><span>关于</span></a></nav>
</div>
<div class="widgets">
<widget class="widget-wrapper post-list"><div class="widget-header dis-select"><span class="name">专栏：Go Web 开发基础课程</span></div><div class="widget-body"><a class="item active" href="/posts/gin-simple-tutorial/"><span class="title">Gin 简易教程</span><svg class="active-icon" xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="currentColor" d="M21 11.098v4.993c0 3.096 0 4.645-.734 5.321c-.35.323-.792.526-1.263.58c-.987.113-2.14-.907-4.445-2.946c-1.02-.901-1.529-1.352-2.118-1.47a2.225 2.225 0 0 0-.88 0c-.59.118-1.099.569-2.118 1.47c-2.305 2.039-3.458 3.059-4.445 2.945a2.238 2.238 0 0 1-1.263-.579C3 20.736 3 19.188 3 16.091v-4.994C3 6.81 3 4.666 4.318 3.333C5.636 2 7.758 2 12 2c4.243 0 6.364 0 7.682 1.332C21 4.665 21 6.81 21 11.098" opacity=".5"/><path fill="currentColor" d="M9 5.25a.75.75 0 0 0 0 1.5h6a.75.75 0 0 0 0-1.5z"/></svg></a><a class="item" href="/posts/gorm-simple-tutorial/"><span class="title">Gorm 简易教程</span></a></div></widget>

<widget class="widget-wrapper post-list"><div class="widget-header dis-select"><span class="name">最近更新</span><a class="cap-action" id="rss" title="Subscribe" href="/atom.xml"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="currentColor" d="M5 21q-.825 0-1.412-.587T3 19q0-.825.588-1.412T5 17q.825 0 1.413.588T7 19q0 .825-.587 1.413T5 21m13.5 0q-.65 0-1.088-.475T16.9 19.4q-.275-2.425-1.312-4.537T12.9 11.1q-1.65-1.65-3.762-2.687T4.6 7.1q-.65-.075-1.125-.512T3 5.5q0-.65.45-1.062t1.075-.363q3.075.275 5.763 1.563t4.737 3.337q2.05 2.05 3.338 4.738t1.562 5.762q.05.625-.363 1.075T18.5 21m-6 0q-.625 0-1.075-.437T10.85 19.5q-.225-1.225-.787-2.262T8.65 15.35q-.85-.85-1.888-1.412T4.5 13.15q-.625-.125-1.062-.575T3 11.5q0-.65.45-1.075t1.075-.325q1.825.25 3.413 1.063t2.837 2.062q1.25 1.25 2.063 2.838t1.062 3.412q.1.625-.325 1.075T12.5 21"/></svg></a></div><div class="widget-body fs14"><a class="item title" href="/posts/vote-system-exception/"><span class="title">记一次投票系统异常</span></a><a class="item title" href="/posts/windows-server-deploy-asp-website/"><span class="title">Windows Server 部署 ASP 网站</span></a><a class="item title" href="/posts/ubuntu-deploy-gin-and-vue-project/"><span class="title">Ubuntu 部署 Gin+Vue 前后端分离项目</span></a><a class="item title" href="/posts/ubuntu-install-docker/"><span class="title">Ubuntu 安装 Docker</span></a><a class="item title" href="/posts/ubuntu-install-redis/"><span class="title">Ubuntu 安装 Redis 并配置远程连接</span></a></div></widget>
</div>

</div></aside><div class="l_main" id="main">





<div class="article banner top">
  <div class="content">
    <div class="top bread-nav footnote"><div class="left"><div class="flex-row" id="breadcrumb"><a class="cap breadcrumb" href="/">主页</a>
<span class="sep"></span><a class="cap breadcrumb" id="menu" href="/topic">专栏</a><span class="sep"></span><a class="cap breadcrumb" id="proj" href="/posts/gin-simple-tutorial/">Go Web 开发基础课程</a></div>
<div class="flex-row" id="post-meta"><span class="text created">发布于：<time datetime="2023-08-13T01:30:00.000Z">2023-08-13</time></span><span class="sep updated"></span><span class="text updated">更新于：<time datetime="2024-08-11T12:53:23.545Z">2024-08-11</time></span></div></div></div>
    
    <div class="bottom only-title">
      
      <div class="text-area">
        <h1 class="text title"><span>Gin 简易教程</span></h1>
        
      </div>
    </div>
    
  </div>
  </div><article class="md-text content"><p>精弘网络 2023 暑期后端 Go Web 开发基础课程 —— Gin 框架<br><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1o841197jX/?share_source=copy_web&vd_source=220eb9848825e3e6c13414db26a32f45">B 站授课链接点击此处</a></p>
<h2 id="引入"><a href="#引入" class="headerlink" title="引入"></a>引入</h2><h3 id="Go-内置的-net-http-包"><a href="#Go-内置的-net-http-包" class="headerlink" title="Go 内置的 net&#x2F;http 包"></a>Go 内置的 net&#x2F;http 包</h3><ul>
<li>Go 语言内置的 net&#x2F;http 包十分优秀，提供了 HTTP 客户端和服务端的实现</li>
<li>这里使用 Go 语言中的 net&#x2F;http 包来编写一个简单的接收 HTTP 请求的服务端（后端）示例，具体的代码如下：</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">&quot;fmt&quot;</span></span><br><span class="line">    <span class="string">&quot;net/http&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// SayHello 函数是需要我们自己实现的一个函数，它有两个规定的参数</span></span><br><span class="line"><span class="comment">// 第一个参数用于给前端的响应（Response）写入数据，响应想要返回什么，就往这个参数里面写什么</span></span><br><span class="line"><span class="comment">// 第二个参数用于获取前端发送的请求（Request）</span></span><br><span class="line"><span class="comment">// Web 开发的本质就是一个请求对应一个响应的过程</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">SayHello</span><span class="params">(w http.ResponseWriter, r *http.Request)</span></span> &#123;</span><br><span class="line">    <span class="comment">// fmt 包中的 Fprintln 函数是一个简单的可以往 w 里写东西的函数</span></span><br><span class="line">    <span class="comment">// 使用 Fprintln 函数将 &quot;Hello 精弘!&quot; 这句话以纯文本的形式写进 w 后返回给前端</span></span><br><span class="line">    fmt.Fprintln(w, <span class="string">&quot;Hello 精弘!&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="comment">// HandleFunc 函数接受两个参数，第一个是路径，即前端请求的 URL，另一个是回调函数，用于处理前端发送的请求</span></span><br><span class="line">    <span class="comment">// HandleFunc 函数是一个设置路由的函数，它的作用是将前端对 /hello 路径的请求映射到 SayHello 函数</span></span><br><span class="line">    <span class="comment">// 当前端访问 /hello 路径的时候，就去执行 SayHello 的函数，往响应写入 &quot;Hello 精弘!&quot; 后返回给前端</span></span><br><span class="line">    http.HandleFunc(<span class="string">&quot;/hello&quot;</span>, SayHello)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ListenAndServe 函数用于启动服务（Serve）并监听（Listen），接收两个参数</span></span><br><span class="line">    <span class="comment">// 第一个参数是 ip:port 格式的 string 参数，给 /hello 路径确定访问它的 ip 地址和端口号</span></span><br><span class="line">    <span class="comment">// 第二个参数指的是处理 HTTP 请求的处理器，填入nil表示使用默认的处理器</span></span><br><span class="line">    <span class="comment">// &quot;:8080&quot; 是简写，省略了 ip，默认为本机的所有 ip 如 127.0.0.1 就是其中一个，端口号指定为 8080</span></span><br><span class="line">    <span class="comment">// 在浏览器（前端）访问 127.0.0.1:8080/hello 就可以看到 SayHello 函数做出的响应了</span></span><br><span class="line">    <span class="comment">// 另外有一个 err 参数，如果端口被占用或者启动失败会返回错误，正常启动则返回 nil，即空（没有错误）</span></span><br><span class="line">    err := http.ListenAndServe(<span class="string">&quot;:8080&quot;</span>, <span class="literal">nil</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 错误处理，如果错误不为 nil 则在终端打印错误</span></span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Printf(<span class="string">&quot;http server failed, err:%v\n&quot;</span>, err)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>将上面的代码编译运行后，在浏览器的地址栏中输入<code>127.0.0.1:8080/hello</code>后回车，就能够看到如下页面：<br><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://img.lonesome.cn/blog/go-web/Nyw4d2eA.webp"></p>
<h3 id="Web-框架"><a href="#Web-框架" class="headerlink" title="Web 框架"></a>Web 框架</h3><ul>
<li>什么是 Web 框架<ul>
<li>用于进行 Web 开发的一套软件架构</li>
<li>为 Web 应用程序提供了基础的功能</li>
</ul>
</li>
<li>优点<ul>
<li>可以利用它更容易、方便、快速的做一些事情</li>
</ul>
</li>
<li>缺点<ul>
<li>作为一套体系，它会有一些自己的规定或约束，不可能百分百的满足你的需求</li>
</ul>
</li>
<li>为什么要用 Web 框架<ul>
<li>如果从零开始，利用 Go 的基础库去搭建，过程会很繁琐</li>
</ul>
</li>
<li>主要作用<ul>
<li>简化应用开发</li>
<li>在 Web 框架的基础上实现自己的业务逻辑</li>
<li>框架提供基础功能</li>
<li>只需要专注应用的业务逻辑</li>
</ul>
</li>
</ul>
<h2 id="初识"><a href="#初识" class="headerlink" title="初识"></a>初识</h2><h3 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h3><p>Gin 是 Go 世界里最流行的一个 Web 框架，Github 上有 69K+ star，封装比较优雅，API 友好，源码注释比较明确，  是一个简单易用的轻量级框架，并且<a target="_blank" rel="noopener" href="https://gin-gonic.com/zh-cn/">中文文档</a>齐全。</p>
<h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><p>1、先初始化当前文件夹（如果没有初始化）</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ go mod init `name`</span><br></pre></td></tr></table></figure>

<p>2、下载并安装 Gin<br>go get 是 go 安装软件包的下载命令</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ go get -u github.com/gin-gonic/gin</span><br></pre></td></tr></table></figure>

<h3 id="开始"><a href="#开始" class="headerlink" title="开始"></a>开始</h3><p>将上节课的代码用 Gin 框架来实现</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 将 gin 引入到代码中</span></span><br><span class="line">    <span class="string">&quot;github.com/gin-gonic/gin&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// SayHello 函数是一个处理 HTTP 请求的回调函数</span></span><br><span class="line"><span class="comment">// 接受一个 gin 封装过的规定参数，即上下文对象 Context，它是所有请求处理器（处理请求的函数或方法）的入口参数</span></span><br><span class="line"><span class="comment">// Context 包含了 Request 和 ResponseWriter 两个参数，用于获取前端请求信息和返回响应</span></span><br><span class="line"><span class="comment">// 本质上是对于 Request 和 Response 的封装，提供了丰富的方法用于获取当前请求的上下文信息以及返回响应</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">SayHello</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">    <span class="comment">// 200 表示 HTTP 响应状态码（&lt;=&gt; http.StatusOK）</span></span><br><span class="line">    <span class="comment">// 使用 Context 的 String 函数将 &quot;Hello 精弘!&quot; 这句话以纯文本（字符串）的形式返回给前端</span></span><br><span class="line">    <span class="comment">// 实际上是对返回响应的封装</span></span><br><span class="line">    c.String(<span class="number">200</span>, <span class="string">&quot;Hello 精弘!&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="comment">// gin.Default 函数会生成一个默认的 Engine（路由引擎）对象（集成了 Logger 和 Recovery 两个中间件，中间件后面的课会讲）</span></span><br><span class="line">    <span class="comment">// 变量名 r 是 router（路由）的一个简写</span></span><br><span class="line">    <span class="comment">// Engine 是 Gin 框架最重要的数据结构，它是 Gin 框架的入口，本质上是一个 Http Handler</span></span><br><span class="line">    <span class="comment">// 它是一个用于处理 HTTP 请求的对象，维护了一张路由表，将不同的 HTTP 请求路径映射到不同的处理函数上</span></span><br><span class="line">    r := gin.Default()</span><br><span class="line"></span><br><span class="line">    <span class="comment">// r.GET 函数接受两个参数，一个是路径，即前端请求的 URL，另一个是回调函数，用于处理前端发送的请求</span></span><br><span class="line">    <span class="comment">// r.GET 函数将 /hello 路径添加到了 r 的路由表中，将对 /hello 路径的 GET 请求映射到 SayHello 函数上</span></span><br><span class="line">    <span class="comment">// 表示前端给后端的 /hello 路由发送一个 HTTP 的 GET 请求时</span></span><br><span class="line">    <span class="comment">// 后端会执行后面的 SayHello 函数，对前端的请求做出一个响应，给前端返回一个 &quot;Hello 精弘!&quot; 的字符串</span></span><br><span class="line">    r.GET(<span class="string">&quot;/hello&quot;</span>, SayHello)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 启动服务并监听,只接受一个 ip:port 格式的 string 参数，表示服务运行的 ip 地址和端口号</span></span><br><span class="line">    <span class="comment">// &quot;:8080&quot; 是简写，省略了 ip，表示监听本地所有 ip （如 127.0.0.1）的 8080 端口，接收并处理 HTTP 请求</span></span><br><span class="line">    <span class="comment">// 在浏览器（前端）访问 127.0.0.1:8080/hello 就可以看到 SayHello 函数做出的响应</span></span><br><span class="line">    <span class="comment">// 等价于 r.Run()，将 port 端口也省略，默认为 8080 端口</span></span><br><span class="line">    err := r.Run(<span class="string">&quot;:8080&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 错误处理，如果错误不为 nil 则在终端打印错误</span></span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Printf(<span class="string">&quot;http server failed, err:%v\n&quot;</span>, err)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>将上面的代码编译运行后，在浏览器的地址栏中输入<code>127.0.0.1:8080/hello</code>后回车，就能够看到和上节一样的页面：<br><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://img.lonesome.cn/blog/go-web/Nyw4d2eA.webp"></p>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.runoob.com/http/http-status-codes.html">HTTP 状态码</a><ul>
<li>当浏览者访问一个网页时，浏览者的浏览器会向网页所在服务器发出请求，当浏览器接收并显示网页前，此网页所在的服务器会返回一个包含 HTTP 状态码的信息头（server header）用以响应浏览器的请求</li>
<li>常见的 HTTP 状态码<ul>
<li>200 - 请求成功</li>
<li>301 - 资源（网页等）被永久转移到其它 URL</li>
<li>404 - 请求的资源（网页等）不存在</li>
<li>500 - 内部服务器错误</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="响应返回-JSON"><a href="#响应返回-JSON" class="headerlink" title="响应返回 JSON"></a>响应返回 JSON</h2><h3 id="String"><a href="#String" class="headerlink" title="String"></a>String</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">r.GET(<span class="string">&quot;/hello&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">        c.String(<span class="number">200</span>, <span class="string">&quot;Hello 精弘!&quot;</span>)</span><br><span class="line">    &#125;)</span><br></pre></td></tr></table></figure>

<p>上节课我们讲的是 c.String 给前端返回一个字符串，但在实际的前后端分离的开发过程中，直接使用 string 进行前后端数据传输并不便利，所以我们往往会选择使用 JSON 的数据格式进行前后端的数据传输</p>
<h3 id="JSON"><a href="#JSON" class="headerlink" title="JSON"></a>JSON</h3><ul>
<li>JSON 数据类型<ul>
<li>JSON(JavaScript Object Notation, JS 对象简谱) 是一种轻量级的数据交换格式，用它可以来表示各种各样复杂的数据，如对象，数组，集合，以及集合的集合等数据</li>
<li>JSON 实际上就是一串字符串，只不过元素会使用特定的符号标注。 {} 双括号表示对象，[] 中括号表示数组，”” 双引号内是属性或值，: 冒号表示后者是前者的值(这个值可以是字符串、数字、也可以是另一个数组或对象)。</li>
</ul>
</li>
<li>一些常见的 JSON 格式<ul>
<li>一个 JSON 对象——JSONObject<ul>
<li><code>&#123;&quot;name&quot;:&quot;XiMo&quot;, &quot;age&quot;:3&#125;</code></li>
<li><code>&#123;&quot;name&quot;:&quot;XiMo&quot;, &quot;age&quot;:3，&quot;address&quot;:&#123;&quot;city&quot;:HangZhou&quot;, &quot;country&quot;:&quot;China&quot;&#125;&#125;</code></li>
</ul>
</li>
<li>一个 JSON 数组——JSONArray<ul>
<li><code>[&quot;XiMo&quot;, &quot;惜寞&quot;]</code></li>
<li><code>[&#123;&quot;name&quot;:&quot;XiMo&quot;, &quot;age&quot;:3&#125;, &#123;&quot;name&quot;:&quot;惜寞&quot;, &quot;age&quot;:4&#125;]</code></li>
<li><code>[&#123;&quot;name&quot;:&quot;XiMo&quot;, &quot;age&quot;:3, &quot;address&quot;:&#123;&quot;city&quot;:&quot;HangZhou&quot;, &quot;country&quot;:&quot;China&quot;&#125;&#125;, &#123;&quot;name&quot;:&quot;惜寞&quot;, &quot;age&quot;: 4, &quot;address&quot;:&#123;&quot;city&quot;:&quot;JiaXing&quot;, &quot;country&quot;:&quot;China&quot;&#125;&#125;]</code></li>
</ul>
</li>
<li>可以通过<a target="_blank" rel="noopener" href="http://www.esjson.com/jsonviewer.html">可视化</a>将 JSON 数据类型格式化来查看，结构清晰，并且内容相同，字符串形式只是将空格回车给去掉了而已</li>
<li>当然，数组可以包含对象，在对象中也可以包含数组</li>
</ul>
</li>
<li>为什么普遍选择 JSON 用于前后端数据的传输<ul>
<li>采用完全独立于任何程序语言的文本格式，使 JSON 成为理想的数据交换语言</li>
<li>易于人阅读和编写，键值对类型的数据结构具有良好的可读性</li>
<li>数据格式比较简单, 格式都是压缩的，占用带宽小，能有效地提升网络传输效率</li>
<li>易于解析，前端可以很方便的进行 JSON 数据的读取</li>
<li>JSON 格式能够直接为后端代码使用，大大简化了前后端的代码开发量，但是完成的任务不变，且易于维护</li>
</ul>
</li>
</ul>
<p>和返回 string 一样，Gin 在 Context 里面也给我们封装了返回 JSON 的方法，下面是一个简单的 Gin 返回 JSON 的示例代码：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">&quot;github.com/gin-gonic/gin&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Json</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">    <span class="comment">// 1.使用结构体，可以灵活利用 tag 对字段进行&quot;换名&quot;</span></span><br><span class="line">    <span class="keyword">type</span> UserInfo <span class="keyword">struct</span> &#123;</span><br><span class="line">        Name     <span class="type">string</span> <span class="string">`json:&quot;username&quot;`</span></span><br><span class="line">        Age      <span class="type">int</span>    <span class="string">`json:&quot;age&quot;`</span></span><br><span class="line">        Password <span class="type">string</span> <span class="string">`json:&quot;-&quot;`</span> <span class="comment">// 忽略该字段</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    user := UserInfo&#123;</span><br><span class="line">        Name:     <span class="string">&quot;XiMo&quot;</span>,</span><br><span class="line">        Age:      <span class="number">3</span>,</span><br><span class="line">        Password: <span class="string">&quot;123456&quot;</span>,</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// c.JSON 实际上是将结构体和 map 类型的变量进行序列化（将对象转换为JSON格式的字符串的过程）</span></span><br><span class="line">    <span class="comment">// 注意 UserInfo.Name 在序列化中变成了 &quot;username&quot;，UserInfo.Age 变成了 &quot;age&quot;</span></span><br><span class="line">    <span class="comment">// &quot;-&quot; 表示忽略该字段，所以 UserInfo.Password 在序列化的时候会被忽略</span></span><br><span class="line">    <span class="comment">// 响应将返回：&#123;&quot;username&quot;: &quot;XiMo&quot;, &quot;age&quot;: 3&#125;</span></span><br><span class="line">    c.JSON(<span class="number">200</span>, user)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// // 2.使用 map</span></span><br><span class="line">    <span class="comment">// userMap := map[string]any&#123;</span></span><br><span class="line">    <span class="comment">//     &quot;name&quot;: &quot;XiMo&quot;,</span></span><br><span class="line">    <span class="comment">//     &quot;age&quot;:  3,</span></span><br><span class="line">    <span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// c.JSON(200, userMap)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// // 3.使用 gin.H</span></span><br><span class="line">    <span class="comment">// // gin.H 实际上是 map[string]any 的一种快捷方式</span></span><br><span class="line">    <span class="comment">// c.JSON(200, gin.H&#123;</span></span><br><span class="line">    <span class="comment">//     &quot;name&quot;: &quot;XiMo&quot;,</span></span><br><span class="line">    <span class="comment">//     &quot;age&quot;:  3,</span></span><br><span class="line">    <span class="comment">// &#125;)</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    r := gin.Default()</span><br><span class="line"></span><br><span class="line">    r.GET(<span class="string">&quot;/json&quot;</span>, Json)</span><br><span class="line"></span><br><span class="line">    r.Run()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>其实除了 JSON 和 string 类型的返回，Gin 还给我们提供了响应 XML、YAML、HTML 等的方式，但由于使用较少，所以这里不多涉及，感兴趣的可以自行查阅</p>
<h2 id="获取参数"><a href="#获取参数" class="headerlink" title="获取参数"></a>获取参数</h2><h3 id="Query-查询参数"><a href="#Query-查询参数" class="headerlink" title="Query 查询参数"></a>Query 查询参数</h3><ul>
<li>Query 参数是在 URL 中的一部分，用于向服务器发送额外的数据，由键值对组成，以 <code>?</code> 为起始符号，键值对之间使用 <code>&amp;</code> 分隔，例如：<code>/user/search?name=XiMo&amp;age=3</code></li>
<li>Query 参数常用于 HTTP GET 请求</li>
<li>常见的地方有搜索（浏览器等等）<br><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://img.lonesome.cn/blog/go-web/fksrMZry.webp"></li>
</ul>
<p>Gin 里面给我们封装的 Context 参数提供了丰富的方法帮我们获取 Query 参数</p>
<table>
<thead>
<tr>
<th>Query 方法</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>Query</td>
<td>获取 key 对应的值，不存在返回空字符串</td>
</tr>
<tr>
<td>DefaultQuery</td>
<td>key 不存在时返回一个默认值</td>
</tr>
<tr>
<td>GetQuery</td>
<td>获取 key 对应的值，并且返回 bool 标识，标识成功或者失败</td>
</tr>
<tr>
<td>QueryArray</td>
<td>获取 key 对应的值，值是一个字符串数组，不存在返回空字符串数组</td>
</tr>
<tr>
<td>GetQueryArray</td>
<td>获取 key 对应的值，并且返回 bool 标识，标识成功或者失败</td>
</tr>
<tr>
<td>QueryMap</td>
<td>获取 key 对应的值，值是一个字符串 map[string]string，不存在返回空</td>
</tr>
<tr>
<td>GetQueryMap</td>
<td>获取 key 对应的值，值是一个字符串 map[string]string，并且返回 bool 标识，标识成功或者失败</td>
</tr>
</tbody></table>
<p>需要注意的是通过 Query 获取到的参数都是 string 类型</p>
<p>下面是一些代码示例：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">&quot;github.com/gin-gonic/gin&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Query</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">    <span class="comment">// 访问 /query?name=ximo&amp;age=3&amp;sex=</span></span><br><span class="line">    <span class="comment">// Query 获取key对应的值，不存在返回空字符串</span></span><br><span class="line">    nameQuery := c.Query(<span class="string">&quot;name&quot;</span>)</span><br><span class="line">    ageQuery := c.Query(<span class="string">&quot;age&quot;</span>)</span><br><span class="line">    sexQuery := c.Query(<span class="string">&quot;sex&quot;</span>)</span><br><span class="line">    organizationQuery := c.Query(<span class="string">&quot;organization&quot;</span>)</span><br><span class="line">    c.JSON(<span class="number">200</span>, gin.H&#123;</span><br><span class="line">        <span class="string">&quot;nameQuery&quot;</span>:         nameQuery,</span><br><span class="line">        <span class="string">&quot;ageQuery&quot;</span>:          ageQuery,</span><br><span class="line">        <span class="string">&quot;sexQuery&quot;</span>:          sexQuery,</span><br><span class="line">        <span class="string">&quot;organizationQuery&quot;</span>: organizationQuery,</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// // 访问 /query?name=ximo&amp;age=3&amp;sex=</span></span><br><span class="line">    <span class="comment">// // DefaultQuery key不存在时返回一个默认值</span></span><br><span class="line">    <span class="comment">// organizationDefaultQuery := c.DefaultQuery(&quot;organization&quot;, &quot;精弘网络&quot;)</span></span><br><span class="line">    <span class="comment">// sexDefaultQuery := c.DefaultQuery(&quot;sex&quot;, &quot;male&quot;)</span></span><br><span class="line">    <span class="comment">// nameDefaultQuery := c.DefaultQuery(&quot;name&quot;, &quot;惜寞&quot;)</span></span><br><span class="line">    <span class="comment">// c.JSON(200, gin.H&#123;</span></span><br><span class="line">    <span class="comment">//  &quot;organizationDefaultQuery&quot;: organizationDefaultQuery,</span></span><br><span class="line">    <span class="comment">//  &quot;sexDefaultQuery&quot;:          sexDefaultQuery,</span></span><br><span class="line">    <span class="comment">//  &quot;nameDefaultQuery&quot;:         nameDefaultQuery,</span></span><br><span class="line">    <span class="comment">// &#125;)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// // 访问 /query?name=ximo&amp;age=3&amp;sex=</span></span><br><span class="line">    <span class="comment">// // GetQuery 获取key对应的值，并且返回bool标识，标识成功或者失败</span></span><br><span class="line">    <span class="comment">// nameGetQuery, nameExist := c.GetQuery(&quot;name&quot;)</span></span><br><span class="line">    <span class="comment">// sexGetQuery, sexExist := c.GetQuery(&quot;sex&quot;)</span></span><br><span class="line">    <span class="comment">// organizationGetQuery, orgaorganizationExist := c.GetQuery(&quot;organization&quot;)</span></span><br><span class="line">    <span class="comment">// c.JSON(200, gin.H&#123;</span></span><br><span class="line">    <span class="comment">//  &quot;nameGetQuery&quot;:          nameGetQuery,</span></span><br><span class="line">    <span class="comment">//  &quot;nameExist&quot;:             nameExist,</span></span><br><span class="line">    <span class="comment">//  &quot;sexGetQuery&quot;:           sexGetQuery,</span></span><br><span class="line">    <span class="comment">//  &quot;sexExist&quot;:              sexExist,</span></span><br><span class="line">    <span class="comment">//  &quot;organizationGetQuery&quot;:  organizationGetQuery,</span></span><br><span class="line">    <span class="comment">//  &quot;orgaorganizationExist&quot;: orgaorganizationExist,</span></span><br><span class="line">    <span class="comment">// &#125;)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// // 访问 /query?name=ximo&amp;age=3&amp;sex=&amp;hobby=code&amp;hobby=sleep&amp;hobby=</span></span><br><span class="line">    <span class="comment">// // QueryArray</span></span><br><span class="line">    <span class="comment">// hobbyQuery := c.Query(&quot;hobby&quot;)</span></span><br><span class="line">    <span class="comment">// hobbyQueryArray := c.QueryArray(&quot;hobby&quot;)</span></span><br><span class="line">    <span class="comment">// nameQueryArray := c.QueryArray(&quot;name&quot;)</span></span><br><span class="line">    <span class="comment">// sexQueryArray := c.QueryArray(&quot;sex&quot;)</span></span><br><span class="line">    <span class="comment">// organizationQueryArray := c.QueryArray(&quot;organization&quot;)</span></span><br><span class="line">    <span class="comment">// c.JSON(200, gin.H&#123;</span></span><br><span class="line">    <span class="comment">//  &quot;hobbyQuery&quot;:             hobbyQuery,</span></span><br><span class="line">    <span class="comment">//  &quot;hobbyQueryArray&quot;:        hobbyQueryArray,</span></span><br><span class="line">    <span class="comment">//  &quot;nameQueryArray&quot;:         nameQueryArray,</span></span><br><span class="line">    <span class="comment">//  &quot;sexQueryArray&quot;:          sexQueryArray,</span></span><br><span class="line">    <span class="comment">//  &quot;organizationQueryArray&quot;: organizationQueryArray,</span></span><br><span class="line">    <span class="comment">// &#125;)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// // 访问 /query?name=ximo&amp;age=3&amp;sex=&amp;hobby=code&amp;hobby=sleep&amp;hobby=</span></span><br><span class="line">    <span class="comment">// // GetQueryArray</span></span><br><span class="line">    <span class="comment">// hobbyGetQueryArray, hobbyExist := c.GetQueryArray(&quot;hobby&quot;)</span></span><br><span class="line">    <span class="comment">// nameGetQueryArray, nameExist := c.GetQueryArray(&quot;name&quot;)</span></span><br><span class="line">    <span class="comment">// sexGetQueryArray, sexExist := c.GetQueryArray(&quot;sex&quot;)</span></span><br><span class="line">    <span class="comment">// organizationGetQueryArray, orgaorganizationExist := c.GetQueryArray(&quot;organization&quot;)</span></span><br><span class="line">    <span class="comment">// c.JSON(200, gin.H&#123;</span></span><br><span class="line">    <span class="comment">//  &quot;hobbyGetQueryArray&quot;:        hobbyGetQueryArray,</span></span><br><span class="line">    <span class="comment">//  &quot;hobbyExist&quot;:                hobbyExist,</span></span><br><span class="line">    <span class="comment">//  &quot;nameGetQueryArray: &quot;:       nameGetQueryArray,</span></span><br><span class="line">    <span class="comment">//  &quot;nameExist&quot;:                 nameExist,</span></span><br><span class="line">    <span class="comment">//  &quot;sexGetQueryArray&quot;:          sexGetQueryArray,</span></span><br><span class="line">    <span class="comment">//  &quot;sexExist&quot;:                  sexExist,</span></span><br><span class="line">    <span class="comment">//  &quot;organizationGetQueryArray&quot;: organizationGetQueryArray,</span></span><br><span class="line">    <span class="comment">//  &quot;orgaorganizationExist&quot;:     orgaorganizationExist,</span></span><br><span class="line">    <span class="comment">// &#125;)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// // 访问 /query?user[name]=ximo&amp;user[age]=3&amp;user[sex]=&amp;user[hobby]=code&amp;user[hobby]=sleep</span></span><br><span class="line">    <span class="comment">// // QueryMap</span></span><br><span class="line">    <span class="comment">// userQueryMap := c.QueryMap(&quot;user&quot;)</span></span><br><span class="line">    <span class="comment">// adminQueryMap := c.QueryMap(&quot;admin&quot;)</span></span><br><span class="line">    <span class="comment">// c.JSON(200, gin.H&#123;</span></span><br><span class="line">    <span class="comment">//  &quot;userQueryMap&quot;:  userQueryMap,</span></span><br><span class="line">    <span class="comment">//  &quot;adminQueryMap&quot;: adminQueryMap,</span></span><br><span class="line">    <span class="comment">// &#125;)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// // 访问 /query?user[name]=ximo&amp;user[age]=3&amp;user[sex]=&amp;user[hobby]=code&amp;user[hobby]=sleep</span></span><br><span class="line">    <span class="comment">// // GetQueryMap</span></span><br><span class="line">    <span class="comment">// userGetQueryMap, userExist := c.GetQueryMap(&quot;user&quot;)</span></span><br><span class="line">    <span class="comment">// adminGetQueryMap, adminExist := c.GetQueryMap(&quot;admin&quot;)</span></span><br><span class="line">    <span class="comment">// c.JSON(200, gin.H&#123;</span></span><br><span class="line">    <span class="comment">//  &quot;userGetQueryMap&quot;:  userGetQueryMap,</span></span><br><span class="line">    <span class="comment">//  &quot;userExist&quot;:        userExist,</span></span><br><span class="line">    <span class="comment">//  &quot;adminGetQueryMap&quot;: adminGetQueryMap,</span></span><br><span class="line">    <span class="comment">//  &quot;adminExist&quot;:       adminExist,</span></span><br><span class="line">    <span class="comment">// &#125;)</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    r := gin.Default()</span><br><span class="line"></span><br><span class="line">    r.GET(<span class="string">&quot;/query&quot;</span>, Query)</span><br><span class="line"></span><br><span class="line">    r.Run(<span class="string">&quot;:8080&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Param-动态参数"><a href="#Param-动态参数" class="headerlink" title="Param 动态参数"></a>Param 动态参数</h3><ul>
<li>Param 参数获取到的数据类型也是 string 类型</li>
<li>路由形式一般写成 <code>/user/:name/:age</code>，这里的 <code>:</code> 表示后面的参数是一个占位符</li>
<li>请求的参数可以通过 URL 路径传递，<code>name</code> 和 <code>age</code> 可以通过访问 <code>/user/XiMo/3</code> 这个路由去获取 <code>XiMo</code> 和 <code>3</code> ，访问 <code>/user/惜寞/4</code> 可以获取 <code>惜寞</code> 和 <code>4</code></li>
</ul>
<p>Gin 给我们提供了 Param 方法去获取这些参数：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">&quot;github.com/gin-gonic/gin&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    r := gin.Default()</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 注意会匹配 /param/XiMo 但不会匹配 /param/ 或者 /param</span></span><br><span class="line">    r.GET(<span class="string">&quot;/param/:name&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">        <span class="comment">// 访问 /param/XiMo</span></span><br><span class="line">        name := c.Param(<span class="string">&quot;name&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 不存在会返回空字符串</span></span><br><span class="line">        age := c.Param(<span class="string">&quot;age&quot;</span>)</span><br><span class="line"></span><br><span class="line">        c.JSON(<span class="number">200</span>, gin.H&#123;</span><br><span class="line">            <span class="string">&quot;name&quot;</span>: name,</span><br><span class="line">            <span class="string">&quot;age&quot;</span>:  age,</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    r.Run(<span class="string">&quot;:8080&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="PostForm-表单参数"><a href="#PostForm-表单参数" class="headerlink" title="PostForm 表单参数"></a>PostForm 表单参数</h3><ul>
<li>和 Query 很像，不同之处在于数据不通过 URL 来传递，而是处于请求的主体当中</li>
<li>表单参数常用于 POST 请求中</li>
</ul>
<p>Gin 提供的 PostForm 函数与 Query 基本上一一对应的，具体情况见下表：</p>
<table>
<thead>
<tr>
<th>Query 方法</th>
<th>PostForm 方法</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>Query</td>
<td>PostForm</td>
<td>获取 key 对应的值，不存在返回空字符串</td>
</tr>
<tr>
<td>DefaultQuery</td>
<td>DefaultPostForm</td>
<td>key 不存在时返回一个默认值</td>
</tr>
<tr>
<td>GetQuery</td>
<td>GetPostForm</td>
<td>获取 key 对应的值，并且返回 bool 标识，标识成功或者失败</td>
</tr>
<tr>
<td>QueryArray</td>
<td>PostFormArray</td>
<td>获取 key 对应的值，值是一个字符串数组，不存在返回空字符串数组</td>
</tr>
<tr>
<td>GetQueryArray</td>
<td>GetPostFormArray</td>
<td>获取 key 对应的值，并且返回 bool 标识，标识成功或者失败</td>
</tr>
<tr>
<td>QueryMap</td>
<td>PostFormMap</td>
<td>获取 key 对应的值，值是一个字符串 map[string]string，不存在返回空</td>
</tr>
<tr>
<td>GetQueryMap</td>
<td>GetPostFomMap</td>
<td>获取 key 对应的值，值是一个字符串 map[string]string，并且返回 bool 标识，标识成功或者失败</td>
</tr>
</tbody></table>
<p>下面是一些代码示例：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">&quot;github.com/gin-gonic/gin&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">PostForm</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">    <span class="comment">// PostForm 获取key对应的值，不存在返回空字符串</span></span><br><span class="line">    <span class="comment">// name=ximo&amp;age=3&amp;sex=</span></span><br><span class="line">    namePostForm := c.PostForm(<span class="string">&quot;name&quot;</span>)</span><br><span class="line">    agePostForm := c.PostForm(<span class="string">&quot;age&quot;</span>)</span><br><span class="line">    sexPostForm := c.PostForm(<span class="string">&quot;sex&quot;</span>)</span><br><span class="line">    organizationPostForm := c.PostForm(<span class="string">&quot;organization&quot;</span>)</span><br><span class="line">    c.JSON(<span class="number">200</span>, gin.H&#123;</span><br><span class="line">        <span class="string">&quot;namePostForm&quot;</span>:         namePostForm,</span><br><span class="line">        <span class="string">&quot;agePostForm&quot;</span>:          agePostForm,</span><br><span class="line">        <span class="string">&quot;sexPostForm&quot;</span>:          sexPostForm,</span><br><span class="line">        <span class="string">&quot;organizationPostForm&quot;</span>: organizationPostForm,</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// // DefaultPostForm key不存在时返回一个默认值</span></span><br><span class="line">    <span class="comment">// // name=ximo&amp;age=3&amp;sex=</span></span><br><span class="line">    <span class="comment">// organizationDefaultPostForm := c.DefaultPostForm(&quot;organization&quot;, &quot;精弘网络&quot;)</span></span><br><span class="line">    <span class="comment">// sexDefaultPostForm := c.DefaultPostForm(&quot;sex&quot;, &quot;male&quot;)</span></span><br><span class="line">    <span class="comment">// nameDefaultPostForm := c.DefaultPostForm(&quot;name&quot;, &quot;惜寞&quot;)</span></span><br><span class="line">    <span class="comment">// c.JSON(200, gin.H&#123;</span></span><br><span class="line">    <span class="comment">//  &quot;organizationPostForm&quot;:        organizationPostForm,</span></span><br><span class="line">    <span class="comment">//  &quot;organizationDefaultPostForm&quot;: organizationDefaultPostForm,</span></span><br><span class="line">    <span class="comment">//  &quot;sexPostForm&quot;:                 sexPostForm,</span></span><br><span class="line">    <span class="comment">//  &quot;sexDefaultPostForm&quot;:          sexDefaultPostForm,</span></span><br><span class="line">    <span class="comment">//  &quot;namePostForm&quot;:                namePostForm,</span></span><br><span class="line">    <span class="comment">//  &quot;nameDefaultPostForm&quot;:         nameDefaultPostForm,</span></span><br><span class="line">    <span class="comment">// &#125;)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// // GetPostForm 获取key对应的值，并且返回bool标识，标识成功或者失败</span></span><br><span class="line">    <span class="comment">// // name=ximo&amp;age=3&amp;sex=</span></span><br><span class="line">    <span class="comment">// nameGetPostForm, nameExist := c.GetPostForm(&quot;name&quot;)</span></span><br><span class="line">    <span class="comment">// sexGetPostForm, sexExist := c.GetPostForm(&quot;sex&quot;)</span></span><br><span class="line">    <span class="comment">// organizationGetPostForm, orgaorganizationExist := c.GetPostForm(&quot;organization&quot;)</span></span><br><span class="line">    <span class="comment">// c.JSON(200, gin.H&#123;</span></span><br><span class="line">    <span class="comment">//  &quot;nameGetPostForm&quot;:         nameGetPostForm,</span></span><br><span class="line">    <span class="comment">//  &quot;nameExist&quot;:               nameExist,</span></span><br><span class="line">    <span class="comment">//  &quot;sexGetPostForm&quot;:          sexGetPostForm,</span></span><br><span class="line">    <span class="comment">//  &quot;sexExist&quot;:                sexExist,</span></span><br><span class="line">    <span class="comment">//  &quot;organizationGetPostForm&quot;: organizationGetPostForm,</span></span><br><span class="line">    <span class="comment">//  &quot;orgaorganizationExist&quot;:   orgaorganizationExist,</span></span><br><span class="line">    <span class="comment">// &#125;)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// // PostFormArray 获取key对应的值，值是一个字符串数组，不存在返回空字符串数组</span></span><br><span class="line">    <span class="comment">// // name=ximo&amp;age=3&amp;sex=&amp;hobby=code&amp;hobby=sleep&amp;hobby=</span></span><br><span class="line">    <span class="comment">// hobbyPostForm := c.PostForm(&quot;hobby&quot;)</span></span><br><span class="line">    <span class="comment">// hobbyPostFormArray := c.PostFormArray(&quot;hobby&quot;)</span></span><br><span class="line">    <span class="comment">// namePostFormArray := c.PostFormArray(&quot;name&quot;)</span></span><br><span class="line">    <span class="comment">// sexPostFormArray := c.PostFormArray(&quot;sex&quot;)</span></span><br><span class="line">    <span class="comment">// organizationPostFormArray := c.PostFormArray(&quot;organization&quot;)</span></span><br><span class="line">    <span class="comment">// c.JSON(200, gin.H&#123;</span></span><br><span class="line">    <span class="comment">//  &quot;hobbyPostForm&quot;:             hobbyPostForm,</span></span><br><span class="line">    <span class="comment">//  &quot;hobbyPostFormArray&quot;:        hobbyPostFormArray,</span></span><br><span class="line">    <span class="comment">//  &quot;namePostFormArray&quot;:         namePostFormArray,</span></span><br><span class="line">    <span class="comment">//  &quot;sexPostFormArray&quot;:          sexPostFormArray,</span></span><br><span class="line">    <span class="comment">//  &quot;organizationPostFormArray&quot;: organizationPostFormArray,</span></span><br><span class="line">    <span class="comment">// &#125;)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// // GetPostFormArray 获取key对应的值，并且返回bool标识，标识成功或者失败</span></span><br><span class="line">    <span class="comment">// // name=ximo&amp;age=3&amp;sex=&amp;hobby=code&amp;hobby=sleep&amp;hobby=</span></span><br><span class="line">    <span class="comment">// hobbyGetPostFormArray, hobbyExist := c.GetPostFormArray(&quot;hobby&quot;)</span></span><br><span class="line">    <span class="comment">// nameGetPostFormArray, nameExist := c.GetPostFormArray(&quot;name&quot;)</span></span><br><span class="line">    <span class="comment">// sexGetPostFormArray, sexExist := c.GetPostFormArray(&quot;sex&quot;)</span></span><br><span class="line">    <span class="comment">// organizationGetPostFormArray, orgaorganizationExist := c.GetPostFormArray(&quot;organization&quot;)</span></span><br><span class="line">    <span class="comment">// c.JSON(200, gin.H&#123;</span></span><br><span class="line">    <span class="comment">//  &quot;hobbyGetPostFormArray&quot;:        hobbyGetPostFormArray,</span></span><br><span class="line">    <span class="comment">//  &quot;hobbyExist&quot;:                   hobbyExist,</span></span><br><span class="line">    <span class="comment">//  &quot;nameGetPostFormArray: &quot;:       nameGetPostFormArray,</span></span><br><span class="line">    <span class="comment">//  &quot;nameExist&quot;:                    nameExist,</span></span><br><span class="line">    <span class="comment">//  &quot;sexGetPostFormArray&quot;:          sexGetPostFormArray,</span></span><br><span class="line">    <span class="comment">//  &quot;sexExist&quot;:                     sexExist,</span></span><br><span class="line">    <span class="comment">//  &quot;organizationGetPostFormArray&quot;: organizationGetPostFormArray,</span></span><br><span class="line">    <span class="comment">//  &quot;orgaorganizationExist&quot;:        orgaorganizationExist,</span></span><br><span class="line">    <span class="comment">// &#125;)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// // PostFormMap 获取key对应的值，值是一个字符串map[string]string，不存在返回空</span></span><br><span class="line">    <span class="comment">// // user[name]=ximo&amp;user[age]=3&amp;user[sex]=&amp;user[hobby]=code&amp;user[hobby]=sleep</span></span><br><span class="line">    <span class="comment">// userPostFormMap := c.PostFormMap(&quot;user&quot;)</span></span><br><span class="line">    <span class="comment">// adminPostFormMap := c.PostFormMap(&quot;admin&quot;)</span></span><br><span class="line">    <span class="comment">// c.JSON(200, gin.H&#123;</span></span><br><span class="line">    <span class="comment">//  &quot;userPostFormMap&quot;:  userPostFormMap,</span></span><br><span class="line">    <span class="comment">//  &quot;adminPostFormMap&quot;: adminPostFormMap,</span></span><br><span class="line">    <span class="comment">// &#125;)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// // GetPostFormMap 获取key对应的值，值是一个字符串map[string]string，并且返回bool标识，标识成功或者失败</span></span><br><span class="line">    <span class="comment">// // user[name]=ximo&amp;user[age]=3&amp;user[sex]=&amp;user[hobby]=code&amp;user[hobby]=sleep</span></span><br><span class="line">    <span class="comment">// userGetPostFormMap, userExist := c.GetPostFormMap(&quot;user&quot;)</span></span><br><span class="line">    <span class="comment">// adminGetPostFormMap, adminExist := c.GetPostFormMap(&quot;admin&quot;)</span></span><br><span class="line">    <span class="comment">// c.JSON(200, gin.H&#123;</span></span><br><span class="line">    <span class="comment">//  &quot;userGetPostFormMap&quot;:  userGetPostFormMap,</span></span><br><span class="line">    <span class="comment">//  &quot;userExist&quot;:           userExist,</span></span><br><span class="line">    <span class="comment">//  &quot;adminGetPostFormMap&quot;: adminGetPostFormMap,</span></span><br><span class="line">    <span class="comment">//  &quot;adminExist&quot;:          adminExist,</span></span><br><span class="line">    <span class="comment">// &#125;)</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    r := gin.Default()</span><br><span class="line"></span><br><span class="line">    r.POST(<span class="string">&quot;/post-form&quot;</span>, PostForm)</span><br><span class="line"></span><br><span class="line">    r.Run(<span class="string">&quot;:8080&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="GetRawData-原始参数"><a href="#GetRawData-原始参数" class="headerlink" title="GetRawData 原始参数"></a>GetRawData 原始参数</h3><p>我们如果想去获取前端传来的 JSON 数据类型就需要用到这个方法，但是实际上 Gin 帮我们封装了一种更简便的方式（参数绑定里的 ShouldBindJSON 方法），所以这个方法我们很少会用到，因此不专门去讲，有兴趣了解的可以看看</p>
<p>利用 GetRawData 方法可以获取请求体中 body 的内容，我们也是通过这种方式来获取前端给我们传来的 JSON 数据，但实际上通过这个方法我们不仅仅是可以获取 JSON ，还可以获取很多别的一些数据类型像是 xml、html 等等，这里我们仅仅是用获取 JSON 数据为例：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">&quot;encoding/json&quot;</span></span><br><span class="line">    <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="string">&quot;github.com/gin-gonic/gin&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Raw</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">    <span class="comment">// GetRawData 实际上是去获取 request.body 中的内容</span></span><br><span class="line">    <span class="comment">// 它返回两个参数，一个是获取到的 []byte 类型的 body 数据，另一个是 error 类型</span></span><br><span class="line">    <span class="comment">// 这里忽略了 error 的处理</span></span><br><span class="line">    data, _ := c.GetRawData()</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 打印 data 可以看到传过来的原始数据</span></span><br><span class="line">    fmt.Println(data)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 将 []byte 转成 string 类型可以看它实际传过来的内容</span></span><br><span class="line">    fmt.Println(<span class="type">string</span>(data))</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 注：下面是对 JSON 数据类型的处理</span></span><br><span class="line">    <span class="comment">// 我们可以通过 json 包里的 Unmarshal 来对 JSON 数据类型进行反序列化</span></span><br><span class="line">    <span class="comment">// 就是我前几节课所说的用 JSON 中的数据去给结构体和 map 类型变量赋值</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 1.结构体，tag 在反序列化的时候依旧可用，会根据 tag 将对应的值赋给对应的键</span></span><br><span class="line">    <span class="keyword">type</span> UserInfo <span class="keyword">struct</span> &#123;</span><br><span class="line">        Name <span class="type">string</span> <span class="string">`json:&quot;name&quot;`</span></span><br><span class="line">        Age  <span class="type">int</span>    <span class="string">`json:&quot;age&quot;`</span></span><br><span class="line">        Sex  <span class="type">string</span> <span class="string">`json:&quot;sex&quot;`</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> userStruct UserInfo</span><br><span class="line"></span><br><span class="line">    <span class="comment">// JSON 反序列化，会返回一个 error，这里忽略了对其的处理</span></span><br><span class="line">    _ = json.Unmarshal(data, &amp;userStruct)</span><br><span class="line"></span><br><span class="line">    c.JSON(<span class="number">200</span>, userStruct)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// // 2.map</span></span><br><span class="line">    <span class="comment">// var userMap map[string]interface&#123;&#125;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// _ = json.Unmarshal(data, &amp;userMap)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// //获取 JSON 中的 key，注意使用 [&quot;key&quot;] 获取</span></span><br><span class="line">    <span class="comment">// // name := userMap[&quot;name&quot;]</span></span><br><span class="line">    <span class="comment">// // age := userMap[&quot;age&quot;]</span></span><br><span class="line">    <span class="comment">// // sex := userMap[&quot;sex&quot;]</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// c.JSON(200, userMap)</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    r := gin.Default()</span><br><span class="line"></span><br><span class="line">    r.POST(<span class="string">&quot;/raw&quot;</span>, Raw)</span><br><span class="line"></span><br><span class="line">    r.Run()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>我们将上面的代码运行起来，然后可以利用 apifox 新建一个快捷请求去查看效果：<br><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://img.lonesome.cn/blog/go-web/IsmjGIUz.webp"></p>
<p>发送请求后的结果如下：<br><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://img.lonesome.cn/blog/go-web/1yu5vlul.webp"></p>
<p>说明我们成功的收到了前端传来的 JSON 参数并且解析到了我们的结构体和 map 上，并将其响应返回给了前端</p>
<h3 id="Bind-参数绑定"><a href="#Bind-参数绑定" class="headerlink" title="Bind 参数绑定"></a>Bind 参数绑定</h3><p>下面是 Gin 的官方文档给出的介绍：<br>Gin 提供了两类绑定方法：</p>
<ul>
<li><strong>Type</strong> - Must bind<ul>
<li><strong>Methods</strong> - <code>Bind</code>, <code>BindJSON</code>, <code>BindXML</code>, <code>BindQuery</code>, <code>BindYAML</code></li>
<li><strong>Behavior</strong> - 这些方法属于  <code>MustBindWith</code>  的具体调用。 如果发生绑定错误，则请求终止，并触发  <code>c.AbortWithError(400, err).SetType(ErrorTypeBind)</code>。响应状态码被设置为 400 并且  <code>Content-Type</code>  被设置为  <code>text/plain; charset=utf-8</code>。 如果您在此之后尝试设置响应状态码，Gin 会输出日志  <code>[GIN-debug] [WARNING] Headers were already written. Wanted to override status code 400 with 422</code>。 如果您希望更好地控制绑定，考虑使用  <code>ShouldBind</code>  等效方法。</li>
</ul>
</li>
<li><strong>Type</strong> - Should bind<ul>
<li><strong>Methods</strong> - <code>ShouldBind</code>, <code>ShouldBindJSON</code>, <code>ShouldBindXML</code>, <code>ShouldBindQuery</code>, <code>ShouldBindYAML</code></li>
<li><strong>Behavior</strong> - 这些方法属于  <code>ShouldBindWith</code>  的具体调用。 如果发生绑定错误，Gin 会返回错误并由开发者处理错误和请求。</li>
</ul>
</li>
</ul>
<p>使用 Bind 方法时，Gin 会尝试根据 Content-Type 推断如何绑定。 如果你明确知道要绑定什么，可以使用  <code>MustBindWith</code>  或  <code>ShouldBindWith</code>。</p>
<p>你也可以指定必须绑定的字段。 如果一个字段的 tag 加上了  <code>binding:&quot;required&quot;</code>，但绑定时是空值, Gin 会报错。</p>
<ul>
<li>我们一般不会使用 Must Bind 相关的绑定方法，因为绑定一旦发生错误，就会修改你的响应状态码，不便于你对绑定状态的控制</li>
<li>通常使用 Should Bind 方法，发生绑定错误可以自由进行处理</li>
</ul>
<p>简单来说：<br>为了能够更方便的获取请求相关参数，提高开发效率，我们可以基于请求的 <code>Content-Type</code> 识别请求数据类型并利用反射机制自动提取请求中 <code>Query</code>、<code>Param</code>、<code>Form</code>、<code>JSON</code> 等参数到结构体中。 下面的示例代码演示了 <code>ShouldBind()</code> 强大的功能，它能够基于请求自动提取相应类型的数据，并把值绑定到指定的结构体对象中</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">&quot;net/http&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="string">&quot;github.com/gin-gonic/gin&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> UserInfo <span class="keyword">struct</span> &#123;</span><br><span class="line">    Name <span class="type">string</span> <span class="string">`form:&quot;name_form&quot; uri:&quot;name_uri&quot; json:&quot;name_form&quot; binding:&quot;required&quot;`</span> <span class="comment">// binding:&quot;required&quot; tag 表示该属性值不能为空</span></span><br><span class="line">    Age  <span class="type">int</span>    <span class="string">`form:&quot;age_form&quot; uri:&quot;age_uri&quot; json:&quot;age_form&quot;`</span></span><br><span class="line">    Sex  <span class="type">string</span> <span class="string">`form:&quot;sex_form&quot; uri:&quot;sex&quot; json:&quot;sex_form&quot;`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    r := gin.Default()</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 对应反射 tag form</span></span><br><span class="line">    <span class="comment">// 绑定 Query 示例</span></span><br><span class="line">    <span class="comment">// 1. /query?name_form=ximo&amp;age_form=3&amp;sex_form=male 正常响应</span></span><br><span class="line">    <span class="comment">// 2. /query?name_form=ximo&amp;age_form=3&amp;sex_form= 或 /query?name_form=ximo&amp;age_form=3 正常响应</span></span><br><span class="line">    <span class="comment">// 3. /query?age_form=3&amp;sex_form=male 或 /query?name_form=&amp;age_form=3&amp;sex_form=male 返回 error，binding:&quot;required&quot; tag 表示 Name 属性值不能为空</span></span><br><span class="line">    r.GET(<span class="string">&quot;/query&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">        <span class="keyword">var</span> user UserInfo</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 根据请求的 Content-type 自动识别请求数据类型并利用反射机制自动提取请求中的参数到结构体中</span></span><br><span class="line">        <span class="comment">// 会返回一个 error 参数</span></span><br><span class="line">        err := c.ShouldBind(&amp;user)</span><br><span class="line">        <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">            c.JSON(http.StatusBadRequest, gin.H&#123;</span><br><span class="line">                <span class="string">&quot;error&quot;</span>: err.Error(),</span><br><span class="line">            &#125;)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        c.JSON(<span class="number">200</span>, user)</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 对应反射 tag uri</span></span><br><span class="line">    <span class="comment">// 绑定 Param 的示例 /param/ximo/3/male</span></span><br><span class="line">    r.POST(<span class="string">&quot;/param/:name_uri/:age_uri/:sex_uri&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">        <span class="keyword">var</span> user UserInfo</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 获取 Param 比较特殊，不能直接通过 ShouldBind 绑定</span></span><br><span class="line">        err := c.ShouldBindUri(&amp;user)</span><br><span class="line">        <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">            c.JSON(http.StatusBadRequest, gin.H&#123;</span><br><span class="line">                <span class="string">&quot;error&quot;</span>: err.Error(),</span><br><span class="line">            &#125;)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        c.JSON(<span class="number">200</span>, user)</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 对应反射 tag json</span></span><br><span class="line">    <span class="comment">// 绑定 JSON 的示例</span></span><br><span class="line">    <span class="comment">// 1. &#123;&quot;user_json&quot;: &quot;ximo&quot;, &quot;age_json&quot;: 3, &quot;sex_json&quot;: male&#125; 正常响应</span></span><br><span class="line">    <span class="comment">// 2. &#123;&quot;user_json&quot;: &quot;ximo&quot;, &quot;age_json&quot;: 3&#125; 或 &#123;&quot;user_json&quot;: &quot;ximo&quot;, &quot;age_json&quot;: 3, &quot;sex_json&quot;:&quot;&quot;&#125; 正常响应</span></span><br><span class="line">    <span class="comment">// 3. &#123;&quot;age_json&quot;: 3, &quot;sex_json&quot;: male&#125; 或 &#123;&quot;user_json&quot;: &quot;&quot;, &quot;age_json&quot;: 3, &quot;sex_json&quot;: male&#125;返回 error，binding:&quot;required&quot; tag 表示 Name 属性值不能为空</span></span><br><span class="line">    r.POST(<span class="string">&quot;/json&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">        <span class="keyword">var</span> user UserInfo</span><br><span class="line"></span><br><span class="line">        err := c.ShouldBind(&amp;user)</span><br><span class="line">        <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">            c.JSON(http.StatusBadRequest, gin.H&#123;</span><br><span class="line">                <span class="string">&quot;error&quot;</span>: err.Error(),</span><br><span class="line">            &#125;)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        c.JSON(<span class="number">200</span>, user)</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 对应反射 tag form（和 Query 相同）</span></span><br><span class="line">    <span class="comment">// 绑定 form 表单示例</span></span><br><span class="line">    <span class="comment">// 1. name_form=ximo&amp;age_form=3&amp;sex_form=male 正常响应</span></span><br><span class="line">    <span class="comment">// 2. name_form=ximo&amp;age_form=3&amp;sex_form= 或 name_form=ximo&amp;age_form=3 正常响应</span></span><br><span class="line">    <span class="comment">// 3. age_form=3&amp;sex_form=male 或 name_form=&amp;age_form=3&amp;sex_form=male 返回 error，binding:&quot;required&quot; tag 表示 Name 属性值不能为空</span></span><br><span class="line">    r.POST(<span class="string">&quot;/post-form&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">        <span class="keyword">var</span> user UserInfo</span><br><span class="line"></span><br><span class="line">        err := c.ShouldBind(&amp;user)</span><br><span class="line">        <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">            c.JSON(http.StatusBadRequest, gin.H&#123;</span><br><span class="line">                <span class="string">&quot;error&quot;</span>: err.Error(),</span><br><span class="line">            &#125;)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        c.JSON(<span class="number">200</span>, user)</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    r.Run()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><p><code>Should Bind</code> 会按照下面的顺序解析请求中的数据完成绑定：</p>
<ul>
<li><ol>
<li>如果是  <code>GET</code>  请求，只使用  <code>Form</code>  绑定（<code>query</code>）</li>
</ol>
</li>
<li><ol start="2">
<li>其他请求，根据  <code>Content-Type</code>  自动识别对应类型，匹配不上会默认使用  <code>Form</code>（<code>form-data</code>）</li>
</ol>
</li>
</ul>
</li>
<li><p>如果你明确知道要绑定什么数据类型，推荐直接使用 <code>ShouldBindWith</code></p>
</li>
<li><p>比如你明确接收到的是一个 JSON 数据，就可以使用</p>
<ul>
<li><code>ShouldBindWith(&amp;user, binding.JSON)</code></li>
<li>或者 <code>ShouldBindJSON(&amp;user)</code> （实际上是上面方法的缩写，通常写这个）</li>
</ul>
</li>
</ul>
<p>我们主要知道如何用 ShouldBindJSON 去获取前端发送过来的 JSON 数据就可以了</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">&quot;net/http&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="string">&quot;github.com/gin-gonic/gin&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> UserInfo <span class="keyword">struct</span> &#123;</span><br><span class="line">    Name <span class="type">string</span> <span class="string">`json:&quot;name&quot; binding:&quot;required&quot;`</span></span><br><span class="line">    Age  <span class="type">int</span>    <span class="string">`json:&quot;age&quot;`</span></span><br><span class="line">    Sex  <span class="type">string</span> <span class="string">`json:&quot;sex&quot;`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    r := gin.Default()</span><br><span class="line"></span><br><span class="line">    r.POST(<span class="string">&quot;/json&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">        <span class="keyword">var</span> user UserInfo</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 绑定 JSON，接收前端发送过来的 JSON 数据</span></span><br><span class="line">        err := c.ShouldBindJSON(&amp;user)</span><br><span class="line">        <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">            c.JSON(http.StatusBadRequest, gin.H&#123;</span><br><span class="line">                <span class="string">&quot;error&quot;</span>: err.Error(),</span><br><span class="line">            &#125;)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        c.JSON(<span class="number">200</span>, user)</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    r.Run()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="路由"><a href="#路由" class="headerlink" title="路由"></a>路由</h2><p>在 Gin 中，路由是指将 HTTP 请求映射到相应的处理函数的机制</p>
<h3 id="普通路由"><a href="#普通路由" class="headerlink" title="普通路由"></a>普通路由</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">r.GET(<span class="string">&quot;/path&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span>&#123;...&#125;)</span><br><span class="line">r.POST(<span class="string">&quot;/path&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span>&#123;...&#125;)</span><br><span class="line">r.PUT(<span class="string">&quot;/path&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span>&#123;...&#125;)</span><br><span class="line">r.DELETE(<span class="string">&quot;/path&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span>&#123;...&#125;)</span><br></pre></td></tr></table></figure>

<ul>
<li><code>Any</code> 方法<ul>
<li>可以匹配所有 HTTP 请求</li>
</ul>
</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">r.Any(<span class="string">&quot;/path&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;...&#125;)</span><br></pre></td></tr></table></figure>

<ul>
<li><code>NoRoute</code>  方法<ul>
<li>用于处理找不到路由的情况，即当没有匹配到任何定义的路由时执行的处理函数</li>
</ul>
</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">r.NoRoute(<span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;...&#125;)</span><br></pre></td></tr></table></figure>

<ul>
<li><code>NoMethod</code> 方法<ul>
<li>用于处理请求的 HTTP 方法不被允许的情况，即当请求的 HTTP 方法与路由定义的方法不匹配时执行的处理函数</li>
</ul>
</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">r.NoMethod(<span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;...&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="参数路由"><a href="#参数路由" class="headerlink" title="参数路由"></a>参数路由</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">r.GET(<span class="string">&quot;/path/:id&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;...&#125;) <span class="comment">// 匹配带有 id 参数的GET请求</span></span><br><span class="line">r.GET(<span class="string">&quot;/path/*action&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;...&#125;) <span class="comment">// 匹配任意路径的 GET 请求，只要是以 /path 开头</span></span><br></pre></td></tr></table></figure>

<p>通过参数路由，可以根据不同的参数值生成不同的 URL，实现对不同资源的访问。</p>
<h3 id="路由组"><a href="#路由组" class="headerlink" title="路由组"></a>路由组</h3><p>我们可以将拥有共同 URL 前缀的路由划分为一个路由组，习惯性一对 <code>&#123;&#125;</code> 包裹同组的路由，这只是为了看着清晰，用不用 <code>&#123;&#125;</code> 包裹功能上没什么区别<br>通常将路由分组用在划分业务逻辑或划分 API 版本时</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">user := r.Group(<span class="string">&quot;/user&quot;</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        user.POST(<span class="string">&quot;/register&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;...&#125;)</span><br><span class="line">        user.POST(<span class="string">&quot;/login&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;...&#125;)</span><br><span class="line">        user.POST(<span class="string">&quot;/exit&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;...&#125;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">admin := r.Group(<span class="string">&quot;/admin&quot;</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        admin.POST(<span class="string">&quot;/register&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;...&#125;)</span><br><span class="line">        admin.POST(<span class="string">&quot;/login&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;...&#125;)</span><br><span class="line">        admin.POST(<span class="string">&quot;/exit&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;...&#125;)</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>路由组支持嵌套</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">user := r.Group(<span class="string">&quot;/user&quot;</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        user.POST(<span class="string">&quot;/register&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;...&#125;)</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 路由组嵌套</span></span><br><span class="line">        login := user.Group(<span class="string">&quot;/login&quot;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            login.POST(<span class="string">&quot;/email&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;...&#125;)</span><br><span class="line">            login.POST(<span class="string">&quot;/phone&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;...&#125;)</span><br><span class="line">            login.POST(<span class="string">&quot;/password&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;...&#125;)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        user.POST(<span class="string">&quot;/exit&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;...&#125;)</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>其实可以类比成文件夹</p>
<h3 id="RESTful-API"><a href="#RESTful-API" class="headerlink" title="RESTful API"></a>RESTful API</h3><p>REST 与技术无关，代表的是一种软件架构风格，REST 是 Representational State Transfer 的简称，中文翻译为“表征状态转移”或“表现层状态转化”。</p>
<p>简单来说，REST 的含义就是客户端（前端）与 Web 服务器（后端）之间进行交互的时候，使用 HTTP 协议中的 4 个请求方法代表不同的动作。</p>
<ul>
<li><code>GET</code> 用来获取资源</li>
<li><code>POST</code> 用来新建资源</li>
<li><code>PUT</code> 用来更新资源</li>
<li><code>DELETE</code> 用来删除资源</li>
</ul>
<p>只要 API 程序遵循了 REST 风格，那就可以称其为 RESTful API。目前在前后端分离的架构中，前后端基本都是通过 RESTful API 来进行交互。</p>
<p>例如，我们现在要编写一个管理外卖订单的系统，对一个订单进行查询、创建、更新和删除等操作，我们在编写程序的时候就要设计客户端浏览器与我们 Web 服务端交互的方式和路径。按照经验我们通常会设计成如下模式：</p>
<table>
<thead>
<tr>
<th>请求方法</th>
<th>URL</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td>GET</td>
<td>&#x2F;order</td>
<td>查询订单信息</td>
</tr>
<tr>
<td>POST</td>
<td>&#x2F;create_order</td>
<td>创建订单</td>
</tr>
<tr>
<td>POST</td>
<td>&#x2F;update_order</td>
<td>更新订单信息</td>
</tr>
<tr>
<td>POST</td>
<td>&#x2F;delete_order</td>
<td>删除订单</td>
</tr>
</tbody></table>
<p>同样的需求我们按照 RESTful API 设计如下：</p>
<table>
<thead>
<tr>
<th>请求方法</th>
<th>URL</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td>GET</td>
<td>&#x2F;order</td>
<td>查询订单信息</td>
</tr>
<tr>
<td>POST</td>
<td>&#x2F;order</td>
<td>创建订单</td>
</tr>
<tr>
<td>PUT</td>
<td>&#x2F;order</td>
<td>更新订单信息</td>
</tr>
<tr>
<td>DELETE</td>
<td>&#x2F;order</td>
<td>删除订单</td>
</tr>
</tbody></table>
<p>Gin 框架支持开发 RESTful API 的开发。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">    <span class="comment">// 对订单进行增删改查的操作</span></span><br><span class="line">    <span class="comment">// 可能的写法</span></span><br><span class="line">    r.GET(<span class="string">&quot;/order&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;&#125;)</span><br><span class="line">    r.POST(<span class="string">&quot;/create_order&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;&#125;)</span><br><span class="line">    r.POST(<span class="string">&quot;/update_order&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;&#125;)</span><br><span class="line">    r.POST(<span class="string">&quot;/delete_order&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;&#125;)</span><br><span class="line">   </span><br><span class="line">    <span class="comment">// RESRful API 风格</span></span><br><span class="line">    r.GET(<span class="string">&quot;/order&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;...&#125;)</span><br><span class="line">    r.POST(<span class="string">&quot;/order&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;...&#125;)</span><br><span class="line">    r.PUT(<span class="string">&quot;/order&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;...&#125;)</span><br><span class="line">    r.DELETE(<span class="string">&quot;/order&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;...&#125;)</span><br></pre></td></tr></table></figure>

<h2 id="中间件"><a href="#中间件" class="headerlink" title="中间件"></a>中间件</h2><p>Gin 框架允许开发者在处理请求的过程中，加入用户自己的钩子（Hook）函数。这个钩子函数就叫中间件，中间件适合处理一些公共的业务逻辑，比如<strong>登录认证、权限校验、数据分页、记录日志、耗时统计</strong>等。<br>中间件本质上是一个 handler，可以作用在单路由、路由组和全局的 Engine。</p>
<h3 id="定义中间件"><a href="#定义中间件" class="headerlink" title="定义中间件"></a>定义中间件</h3><ul>
<li>Gin 中的中间件必须是一个 <code>gin.HandlerFunc</code> 类型，其实和我们的处理函数是同样的类型。</li>
<li>下面其实就是一个中间件，只不过没有什么实际的作用：</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">m1</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">    fmt.Println(<span class="string">&quot;这是一个中间件&quot;</span>)</span><br><span class="line">   </span><br><span class="line">    <span class="comment">// 中间件也可以返回响应</span></span><br><span class="line">    c.JSON(<span class="number">200</span>, gin.H&#123;</span><br><span class="line">        <span class="string">&quot;msg&quot;</span>: <span class="string">&quot;中间件&quot;</span>,</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>我们可以把它注册到我们的路由当中：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    r := gin.Default()</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 将 m1 作为一个中间件注册到该路由</span></span><br><span class="line">    r.GET(<span class="string">&quot;/&quot;</span>, m1, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">        fmt.Println(<span class="string">&quot;这是处理函数&quot;</span>)</span><br><span class="line"></span><br><span class="line">        c.JSON(<span class="number">200</span>, gin.H&#123;</span><br><span class="line">            <span class="string">&quot;msg&quot;</span>: <span class="string">&quot;处理函数&quot;</span>,</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    r.Run()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>实际上访问 127.0.0.1:8080&#x2F; 的时候会返次两个响应，但是我们基本不会这么写，一次请求对应多次响应是不准确也是不安全的，仅仅是用来做一个示例</li>
<li>根据打印和响应我们也可以发现执行顺序是中间件在处理函数之前</li>
</ul>
<h4 id="Abort-和-Next"><a href="#Abort-和-Next" class="headerlink" title="Abort() 和 Next()"></a>Abort() 和 Next()</h4><ul>
<li><code>Abort()</code><ul>
<li>会中止当前请求，不执行该语句后面的所有内容，即使后面可能处理函数都没有执行</li>
<li>注意和 return 不同，return 只结束该函数内的内容，不影响后续函数的执行</li>
</ul>
</li>
<li><code>Next()</code><ul>
<li>从当前 handler 的调用位置跳到下一个 handler 执行，执行完后续 handler（如果没有再次调用 next ），再返回上一个 next 调用位置继续往下执行</li>
</ul>
</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">m1</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">    fmt.Println(<span class="string">&quot;m1 in...&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 跳到下一个 handler</span></span><br><span class="line">    c.Next()</span><br><span class="line"></span><br><span class="line">    fmt.Println(<span class="string">&quot;m1 out...&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">m2</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">    fmt.Println(<span class="string">&quot;m2 in...&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 跳到下一个 handler</span></span><br><span class="line">    c.Next()</span><br><span class="line"></span><br><span class="line">    fmt.Println(<span class="string">&quot;m2 out...&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    r := gin.Default()</span><br><span class="line"></span><br><span class="line">    r.GET(<span class="string">&quot;/&quot;</span>, m1, m2, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">        fmt.Println(<span class="string">&quot;/ in...&quot;</span>)</span><br><span class="line"></span><br><span class="line">        fmt.Println(<span class="string">&quot;/ out...&quot;</span>)</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    r.Run()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>这里写了两个中间件 m1 和 m2，遇到 Next 后会跳转到下一个 Handler</li>
<li>本质上就是一个函数嵌套调用的过程</li>
<li><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://img.lonesome.cn/blog/go-web/0866b73a-4d10-4d7d-adcf-7ac6c9483a4f.webp"><br>所以运行后的输出结果为：</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">m1 in...</span><br><span class="line">m2 in...</span><br><span class="line">/ in...</span><br><span class="line">/ out...</span><br><span class="line">m2 out...</span><br><span class="line">m1 out...</span><br></pre></td></tr></table></figure>

<p>如果将 m1 中的 <code>c.Next()</code> 换成 <code>c.Abort()</code></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">m1</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">    fmt.Println(<span class="string">&quot;m1 in...&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 终止当前请求，后续函数和代码都不会执行</span></span><br><span class="line">    c.Abort()</span><br><span class="line"></span><br><span class="line">    fmt.Println(<span class="string">&quot;m1 out...&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>运行后的输出结果为：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">m1 in...</span><br></pre></td></tr></table></figure>

<p>运行到 Abort() 就结束了</p>
<h4 id="Set-和-Get"><a href="#Set-和-Get" class="headerlink" title="Set() 和 Get()"></a>Set() 和 Get()</h4><ul>
<li>用于中间件（handler）之间的通信，可以是在 handler 之内，也可以是之间</li>
<li>因为中间件实际上是不同的函数，在不同的函数之间我们不能直接传递数据，想要传递数据就需要用到 Gin 给我们封装好的 Context 中的 Set 和 Get 方法</li>
<li><code>Set</code>：用于在请求上下文中设置数据。可以使用 <code>c.Set(key, value)</code> 方法将某个键和对应的值存储到请求上下文中</li>
<li><code>Get</code>：用于从请求上下文中获取数据。可以使用 <code>c.Get(key)</code> 方法根据键获取在请求上下文中存储的值</li>
<li>先 Set 再 Get</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> UserInfo <span class="keyword">struct</span> &#123;</span><br><span class="line">    Name <span class="type">string</span></span><br><span class="line">    Age  <span class="type">int</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">m1</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">    user := UserInfo&#123;</span><br><span class="line">        Name: <span class="string">&quot;XiMo&quot;</span>,</span><br><span class="line">        Age:  <span class="number">3</span>,</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 将 user 以键值对的形式存储到 Context 中</span></span><br><span class="line">    c.Set(<span class="string">&quot;user&quot;</span>, user)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    r := gin.Default()</span><br><span class="line"></span><br><span class="line">    r.GET(<span class="string">&quot;/&quot;</span>, m1, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">        <span class="comment">// 根据 key 返回 value（any 类型）和一个 bool 值</span></span><br><span class="line">        <span class="comment">// bool 值用来判断是否有这个 key</span></span><br><span class="line">        user, ok := c.Get(<span class="string">&quot;user&quot;</span>)</span><br><span class="line">        fmt.Println(gin.H&#123;</span><br><span class="line">            <span class="string">&quot;userExist&quot;</span>: ok,</span><br><span class="line">        &#125;)</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 断言，会返回断言类型的值和一个 bool 值</span></span><br><span class="line">        <span class="comment">// bool 值用来判断是否断言成功</span></span><br><span class="line">        <span class="comment">// 断言失败，返回的值为断言类型的零值</span></span><br><span class="line">        _user, _ok := user.(UserInfo)</span><br><span class="line">        fmt.Println(gin.H&#123;</span><br><span class="line">            <span class="string">&quot;type assertion&quot;</span>: _ok,</span><br><span class="line">        &#125;)</span><br><span class="line"></span><br><span class="line">        fmt.Println(_user)</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    r.Run()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="记录接口耗时的中间件"><a href="#记录接口耗时的中间件" class="headerlink" title="记录接口耗时的中间件"></a>记录接口耗时的中间件</h4><p>我们可以写一个中间件用来记录接口耗时</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// StatCost 是一个统计请求耗时的中间件</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">StatCost</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">    <span class="comment">// 请求开始的时间</span></span><br><span class="line">    start := time.Now()</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 请求前</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 调用该请求的剩余处理程序</span></span><br><span class="line">    c.Next()</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 请求后</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 计算耗时</span></span><br><span class="line">    cost := time.Since(start)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 日志形式打印</span></span><br><span class="line">    log.Println(cost)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="注册中间件"><a href="#注册中间件" class="headerlink" title="注册中间件"></a>注册中间件</h3><p>在 gin 框架中，我们可以为每个路由添加任意数量的中间件。</p>
<h4 id="为全局路由注册"><a href="#为全局路由注册" class="headerlink" title="为全局路由注册"></a>为全局路由注册</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    r := gin.Default()</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 全局注册 StatCost 中间件</span></span><br><span class="line">    r.Use(StatCost)</span><br><span class="line"></span><br><span class="line">    r.GET(<span class="string">&quot;/&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">        <span class="comment">// 停1秒</span></span><br><span class="line">        time.Sleep(time.Second)</span><br><span class="line"></span><br><span class="line">        c.JSON(<span class="number">200</span>, gin.H&#123;</span><br><span class="line">            <span class="string">&quot;msg&quot;</span>: <span class="string">&quot;Hello 精弘!&quot;</span>,</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    r.Run()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>我们之前所讲的 <code>gin.Default()</code> 实际上就默认帮我们注册了两个全局中间件 <code>Logger()</code> 和 <code>Recovery()</code></li>
<li>如果不想集成这两个中间件可以使用 <code>gin.New()</code> 方法</li>
</ul>
<h4 id="为某个路由单独注册"><a href="#为某个路由单独注册" class="headerlink" title="为某个路由单独注册"></a>为某个路由单独注册</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 给 / 路由单独注册中间件（可注册多个）</span></span><br><span class="line">	r.GET(<span class="string">&quot;/&quot;</span>, StatCost, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">		<span class="comment">// 停1秒</span></span><br><span class="line">        time.Sleep(time.Second)</span><br><span class="line"></span><br><span class="line">        c.JSON(<span class="number">200</span>, gin.H&#123;</span><br><span class="line">            <span class="string">&quot;msg&quot;</span>: <span class="string">&quot;Hello 精弘!&quot;</span>,</span><br><span class="line">        &#125;)</span><br><span class="line">	&#125;)</span><br></pre></td></tr></table></figure>

<h4 id="为路由组注册中间件"><a href="#为路由组注册中间件" class="headerlink" title="为路由组注册中间件"></a>为路由组注册中间件</h4><p>为路由组注册中间件有以下两种写法。<br>写法 1：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">user := r.Group(<span class="string">&quot;/user&quot;</span>, StatCost)</span><br><span class="line">&#123;</span><br><span class="line">    user.POST(<span class="string">&quot;/register&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;...&#125;)</span><br><span class="line">    user.POST(<span class="string">&quot;/login&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;...&#125;)</span><br><span class="line">    user.POST(<span class="string">&quot;/exit&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;...&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>写法 2：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">user := r.Group(<span class="string">&quot;/user&quot;</span>)</span><br><span class="line">user.Use(StatCost)</span><br><span class="line">&#123;</span><br><span class="line">    user.POST(<span class="string">&quot;/register&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;...&#125;)</span><br><span class="line">    user.POST(<span class="string">&quot;/login&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;...&#125;)</span><br><span class="line">    user.POST(<span class="string">&quot;/exit&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;...&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>通过路由组注册中间件易于定义中间件的使用范围<br>比如我只有 &#x2F;admin 相关的路由需要鉴权，判断是不是管理员，就可以通过路由组的方式去管理，而不需要单个一个个的注册或者全局注册（没有必要给所有路由都加上该中间件）</p>

<div class="article-footer fs14">
    <section id="references">
      <div class="header"><span>参考资料</span></div>
      <div class="body">
        <ul>
        <li class="post-title">
          <p><a target="_blank" rel="noopener" href="https://gin-gonic.com/zh-cn/docs/">Gin官方文档</a></p>

        </li>
        
        <li class="post-title">
          <p><a target="_blank" rel="noopener" href="https://www.liwenzhou.com/posts/Go/gin/">李文周的博客——Gin框架介绍与使用</a></p>

        </li>
        </ul>
      </div>
    </section>
    
    <section id="license">
      <div class="header"><span>许可协议</span></div>
      <div class="body"><p>本文采用 <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">署名-非商业性使用-相同方式共享 4.0 国际</a> 许可协议，转载请注明出处。</p>
</div>
    </section>
    
    <section id="share">
      <div class="header"><span>分享文章</span></div>
      <div class="body">
        <div class="link"><input class="copy-area" readonly="true" id="copy-link" value="https://lonesome.cn/posts/gin-simple-tutorial/" /></div>
        <div class="social-wrap dis-select"><a class="social share-item wechat" onclick="util.toggle(&quot;qrcode-wechat&quot;)"><img class="lazy"  src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://gcore.jsdelivr.net/gh/cdn-x/placeholder@1.0.12/social/b32ef3da1162a.svg" /></a><a class="social share-item link" onclick="util.copy(&quot;copy-link&quot;, &quot;复制成功&quot;)"><img class="lazy"  src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://gcore.jsdelivr.net/gh/cdn-x/placeholder@1.0.12/social/8411ed322ced6.svg" /></a></div>
        
        <div class="qrcode" id="qrcode-wechat" style="opacity:0;height:0">
          <img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="https://api.qrserver.com/v1/create-qr-code/?size=256x256&data=https://lonesome.cn/posts/gin-simple-tutorial/"/>
        </div>
        
      </div>
    </section>
    </div>
</article>
<div class="related-wrap" id="read-next"><section class="body"><div class="item" id="prev"><div class="note">较新文章</div><a href="/posts/gorm-simple-tutorial/">Gorm 简易教程</a></div><div class="item" id="next"><div class="note">较早文章</div><a href="/posts/clickhouse-column-storage/">ClickHouse——你没有见过的列存储</a></div></section></div>

<div class="related-wrap" id="related-posts">
    <section class='header'>
      <div class='title cap theme'>您可能感兴趣的文章</div>
    </section>
    <section class='body'>
    <div class="related-posts"><a class="item" href="\posts\go-framework-three-piece-set\" title="Go框架三件套详解（Web/RPC/ORM）"><span class="title">Go框架三件套详解（Web/RPC/ORM）</span></a><a class="item" href="\posts\go-language-basics\" title="Go语言基础——基础语法"><span class="title">Go语言基础——基础语法</span></a><a class="item" href="\posts\go-memory-management\" title="Go语言内存管理详解"><span class="title">Go语言内存管理详解</span></a><a class="item" href="\posts\go-language-advanced\" title="Go语言进阶——工程进阶"><span class="title">Go语言进阶——工程进阶</span></a><a class="item" href="\posts\gorm-simple-tutorial\" title="Gorm 简易教程"><span class="title">Gorm 简易教程</span><span class="excerpt">精弘网络 2023 暑期后端 Go Web 开发基础课程 —— Gorm（MySQL）</span></a></div></section></div>




<footer class="page-footer footnote"><hr><div class="sitemap"><div class="sitemap-group"><span class="fs15">博客</span><a href="/">近期</a><a href="/categories/">分类</a><a href="/tags/">标签</a><a href="/archives/">归档</a></div><div class="sitemap-group"><span class="fs15">社交</span><a href="/friends">友链</a><a href="/about">关于我</a></div><div class="sitemap-group"><span class="fs15">更多</span><a href="/">关于本站</a><a href="/https:/github.com/XiMo-210">GitHub</a></div></div><div class="text"><p>本站由 <a href="/">惜寞</a> 使用 <a target="_blank" rel="noopener" href="https://github.com/xaoxuu/hexo-theme-stellar/tree/1.29.1">Stellar 1.29.1</a> 主题创建。<br>本博客所有文章除特别声明外，均采用 <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> 许可协议，转载请注明出处。<br><a href="https://beian.miit.gov.cn/" target="_blank">浙ICP备2022030617号-3</a></p>
</div></footer>
<div class="main-mask" onclick="sidebar.dismiss()"></div></div><aside class="l_right">
<div class="widgets">



<widget class="widget-wrapper toc" id="data-toc" collapse="false"><div class="widget-header dis-select"><span class="name">本文目录</span><a class="cap-action" onclick="sidebar.toggleTOC()" ><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6h11m-11 6h11m-11 6h11M4 6h1v4m-1 0h2m0 8H4c0-1 2-2 2-3s-1-1.5-2-1"/></svg></a></div><div class="widget-body"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BC%95%E5%85%A5"><span class="toc-text">引入</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Go-%E5%86%85%E7%BD%AE%E7%9A%84-net-http-%E5%8C%85"><span class="toc-text">Go 内置的 net&#x2F;http 包</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Web-%E6%A1%86%E6%9E%B6"><span class="toc-text">Web 框架</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%9D%E8%AF%86"><span class="toc-text">初识</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%8B%E7%BB%8D"><span class="toc-text">介绍</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E8%A3%85"><span class="toc-text">安装</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BC%80%E5%A7%8B"><span class="toc-text">开始</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%93%8D%E5%BA%94%E8%BF%94%E5%9B%9E-JSON"><span class="toc-text">响应返回 JSON</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#String"><span class="toc-text">String</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#JSON"><span class="toc-text">JSON</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E5%8F%82%E6%95%B0"><span class="toc-text">获取参数</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Query-%E6%9F%A5%E8%AF%A2%E5%8F%82%E6%95%B0"><span class="toc-text">Query 查询参数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Param-%E5%8A%A8%E6%80%81%E5%8F%82%E6%95%B0"><span class="toc-text">Param 动态参数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PostForm-%E8%A1%A8%E5%8D%95%E5%8F%82%E6%95%B0"><span class="toc-text">PostForm 表单参数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GetRawData-%E5%8E%9F%E5%A7%8B%E5%8F%82%E6%95%B0"><span class="toc-text">GetRawData 原始参数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Bind-%E5%8F%82%E6%95%B0%E7%BB%91%E5%AE%9A"><span class="toc-text">Bind 参数绑定</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B7%AF%E7%94%B1"><span class="toc-text">路由</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%99%AE%E9%80%9A%E8%B7%AF%E7%94%B1"><span class="toc-text">普通路由</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%82%E6%95%B0%E8%B7%AF%E7%94%B1"><span class="toc-text">参数路由</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B7%AF%E7%94%B1%E7%BB%84"><span class="toc-text">路由组</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RESTful-API"><span class="toc-text">RESTful API</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%AD%E9%97%B4%E4%BB%B6"><span class="toc-text">中间件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9A%E4%B9%89%E4%B8%AD%E9%97%B4%E4%BB%B6"><span class="toc-text">定义中间件</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Abort-%E5%92%8C-Next"><span class="toc-text">Abort() 和 Next()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Set-%E5%92%8C-Get"><span class="toc-text">Set() 和 Get()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AE%B0%E5%BD%95%E6%8E%A5%E5%8F%A3%E8%80%97%E6%97%B6%E7%9A%84%E4%B8%AD%E9%97%B4%E4%BB%B6"><span class="toc-text">记录接口耗时的中间件</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B3%A8%E5%86%8C%E4%B8%AD%E9%97%B4%E4%BB%B6"><span class="toc-text">注册中间件</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%BA%E5%85%A8%E5%B1%80%E8%B7%AF%E7%94%B1%E6%B3%A8%E5%86%8C"><span class="toc-text">为全局路由注册</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%BA%E6%9F%90%E4%B8%AA%E8%B7%AF%E7%94%B1%E5%8D%95%E7%8B%AC%E6%B3%A8%E5%86%8C"><span class="toc-text">为某个路由单独注册</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%BA%E8%B7%AF%E7%94%B1%E7%BB%84%E6%B3%A8%E5%86%8C%E4%B8%AD%E9%97%B4%E4%BB%B6"><span class="toc-text">为路由组注册中间件</span></a></li></ol></li></ol></li></ol></div><div class="widget-footer">

<a class="top" onclick="util.scrollTop()"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-width="1.5"><path d="M2 12c0-4.714 0-7.071 1.464-8.536C4.93 2 7.286 2 12 2c4.714 0 7.071 0 8.535 1.464C22 4.93 22 7.286 22 12c0 4.714 0 7.071-1.465 8.535C19.072 22 16.714 22 12 22s-7.071 0-8.536-1.465C2 19.072 2 16.714 2 12Z"/><path stroke-linecap="round" stroke-linejoin="round" d="m9 15.5l3-3l3 3m-6-4l3-3l3 3"/></g></svg><span>回到顶部</span></a></div></widget>
</div></aside><div class='float-panel blur'>
  <button type='button' style='display:none' class='laptop-only rightbar-toggle mobile' onclick='sidebar.rightbar()'>
    <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6h11m-11 6h11m-11 6h11M4 6h1v4m-1 0h2m0 8H4c0-1 2-2 2-3s-1-1.5-2-1"/></svg>
  </button>
  <button type='button' style='display:none' class='mobile-only leftbar-toggle mobile' onclick='sidebar.leftbar()'>
    <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-width="1.5"><path d="M2 11c0-3.771 0-5.657 1.172-6.828C4.343 3 6.229 3 10 3h4c3.771 0 5.657 0 6.828 1.172C22 5.343 22 7.229 22 11v2c0 3.771 0 5.657-1.172 6.828C19.657 21 17.771 21 14 21h-4c-3.771 0-5.657 0-6.828-1.172C2 18.657 2 16.771 2 13z"/><path id="sep" stroke-linecap="round" d="M5.5 10h6m-5 4h4m4.5 7V3"/></g></svg>
  </button>
</div>
</div><div class="scripts">
<script type="text/javascript">
  const ctx = {
    date_suffix: {
      just: `刚刚`,
      min: `分钟前`,
      hour: `小时前`,
      day: `天前`,
    },
    root : `/`,
  };

  // required plugins (only load if needs)
  if (`local_search`) {
    ctx.search = {};
    ctx.search.service = `local_search`;
    if (ctx.search.service == 'local_search') {
      let service_obj = Object.assign({}, `{"field":"all","path":"/search.json","content":true,"codeblock":true,"sort":"-date"}`);
      ctx.search[ctx.search.service] = service_obj;
    }
  }
  const def = {
    avatar: `https://gcore.jsdelivr.net/gh/cdn-x/placeholder@1.0.12/avatar/round/3442075.svg`,
    cover: `https://gcore.jsdelivr.net/gh/cdn-x/placeholder@1.0.12/cover/76b86c0226ffd.svg`,
  };
  const deps = {
    jquery: `https://cdn.jsdelivr.net/npm/jquery@3.7.1/dist/jquery.min.js`,
    marked: `https://cdn.jsdelivr.net/npm/marked@13.0.1/lib/marked.umd.min.js`
  }
  

</script>

<script type="text/javascript">
  const utils = {
    // 懒加载 css https://github.com/filamentgroup/loadCSS
    css: (href, before, media, attributes) => {
      var doc = window.document;
      var ss = doc.createElement("link");
      var ref;
      if (before) {
        ref = before;
      } else {
        var refs = (doc.body || doc.getElementsByTagName("head")[0]).childNodes;
        ref = refs[refs.length - 1];
      }
      var sheets = doc.styleSheets;
      if (attributes) {
        for (var attributeName in attributes) {
          if (attributes.hasOwnProperty(attributeName)) {
            ss.setAttribute(attributeName, attributes[attributeName]);
          }
        }
      }
      ss.rel = "stylesheet";
      ss.href = href;
      ss.media = "only x";
      function ready(cb) {
        if (doc.body) {
          return cb();
        }
        setTimeout(function () {
          ready(cb);
        });
      }
      ready(function () {
        ref.parentNode.insertBefore(ss, before ? ref : ref.nextSibling);
      });
      var onloadcssdefined = function (cb) {
        var resolvedHref = ss.href;
        var i = sheets.length;
        while (i--) {
          if (sheets[i].href === resolvedHref) {
            return cb();
          }
        }
        setTimeout(function () {
          onloadcssdefined(cb);
        });
      };
      function loadCB() {
        if (ss.addEventListener) {
          ss.removeEventListener("load", loadCB);
        }
        ss.media = media || "all";
      }
      if (ss.addEventListener) {
        ss.addEventListener("load", loadCB);
      }
      ss.onloadcssdefined = onloadcssdefined;
      onloadcssdefined(loadCB);
      return ss;
    },

    js: (src, opt) => new Promise((resolve, reject) => {
      var script = document.createElement('script');
      if (src.startsWith('/')){
        src = ctx.root + src.substring(1);
      }
      script.src = src;
      if (opt) {
        for (let key of Object.keys(opt)) {
          script[key] = opt[key]
        }
      } else {
        // 默认异步，如果需要同步，第二个参数传入 {} 即可
        script.async = true
      }
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    }),

    jq: (fn) => {
      if (typeof jQuery === 'undefined') {
        utils.js(deps.jquery).then(fn)
      } else {
        fn()
      }
    },
    
    onLoading: (el) => {
      if (el) {
        $(el).append('<div class="loading-wrap"><svg xmlns="http://www.w3.org/2000/svg" width="2em" height="2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-width="2"><path stroke-dasharray="60" stroke-dashoffset="60" stroke-opacity=".3" d="M12 3C16.9706 3 21 7.02944 21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3Z"><animate fill="freeze" attributeName="stroke-dashoffset" dur="1.3s" values="60;0"/></path><path stroke-dasharray="15" stroke-dashoffset="15" d="M12 3C16.9706 3 21 7.02944 21 12"><animate fill="freeze" attributeName="stroke-dashoffset" dur="0.3s" values="15;0"/><animateTransform attributeName="transform" dur="1.5s" repeatCount="indefinite" type="rotate" values="0 12 12;360 12 12"/></path></g></svg></div>');
      }
    },
    onLoadSuccess: (el) => {
      if (el) {
        $(el).find('.loading-wrap').remove();
      }
    },
    onLoadFailure: (el) => {
      if (el) {
        $(el).find('.loading-wrap svg').remove();
        $(el).find('.loading-wrap').append('<svg xmlns="http://www.w3.org/2000/svg" width="2em" height="2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"><path stroke-dasharray="60" stroke-dashoffset="60" d="M12 3L21 20H3L12 3Z"><animate fill="freeze" attributeName="stroke-dashoffset" dur="0.5s" values="60;0"/></path><path stroke-dasharray="6" stroke-dashoffset="6" d="M12 10V14"><animate fill="freeze" attributeName="stroke-dashoffset" begin="0.6s" dur="0.2s" values="6;0"/></path></g><circle cx="12" cy="17" r="1" fill="currentColor" fill-opacity="0"><animate fill="freeze" attributeName="fill-opacity" begin="0.8s" dur="0.4s" values="0;1"/></circle></svg>');
        $(el).find('.loading-wrap').addClass('error');
      }
    },
    request: (el, url, callback, onFailure) => {
      let retryTimes = 3;
      utils.onLoading(el);
      function req() {
        return new Promise((resolve, reject) => {
          let status = 0; // 0 等待 1 完成 2 超时
          let timer = setTimeout(() => {
            if (status === 0) {
              status = 2;
              timer = null;
              reject('请求超时');
              if (retryTimes == 0) {
                onFailure();
              }
            }
          }, 5000);
          fetch(url).then(function(response) {
            if (status !== 2) {
              clearTimeout(timer);
              resolve(response);
              timer = null;
              status = 1;
            }
            if (response.ok) {
              return response.json();
            }
            throw new Error('Network response was not ok.');
          }).then(function(data) {
            retryTimes = 0;
            utils.onLoadSuccess(el);
            callback(data);
          }).catch(function(error) {
            if (retryTimes > 0) {
              retryTimes -= 1;
              setTimeout(() => {
                req();
              }, 5000);
            } else {
              utils.onLoadFailure(el);
              onFailure();
            }
          });
        });
      }
      req();
    },
  };
</script>

<script>
  const sidebar = {
    leftbar: () => {
      if (l_body) {
        l_body.toggleAttribute('leftbar');
        l_body.removeAttribute('rightbar');
      }
    },
    rightbar: () => {
      if (l_body) {
        l_body.toggleAttribute('rightbar');
        l_body.removeAttribute('leftbar');
      }
    },
    dismiss: () => {
      if (l_body) {
        l_body.removeAttribute('leftbar');
        l_body.removeAttribute('rightbar');
      }
    },
    toggleTOC: () => {
      document.querySelector('#data-toc').classList.toggle('collapse');
    }
  }
</script>
<script type="text/javascript">
  (() => {
    const tagSwitchers = document.querySelectorAll('.tag-subtree.parent-tag > a > .tag-switcher-wrapper')
    for (const tagSwitcher of tagSwitchers) {
      tagSwitcher.addEventListener('click', (e) => {
        const parent = e.target.closest('.tag-subtree.parent-tag')
        parent.classList.toggle('expanded')
        e.preventDefault()
      })
    }

    // Get active tag from query string, then activate it.
    const urlParams = new URLSearchParams(window.location.search)
    const activeTag = urlParams.get('tag')
    if (activeTag) {
      let tag = document.querySelector(`.tag-subtree[data-tag="${activeTag}"]`)
      if (tag) {
        tag.querySelector('a').classList.add('active')
        
        while (tag) {
          tag.classList.add('expanded')
          tag = tag.parentElement.closest('.tag-subtree.parent-tag')
        }
      }
    }
  })()
</script>


<!-- required -->
<script src="/js/main.js?v=1.29.1" defer></script>

<script type="text/javascript">
  const applyTheme = (theme) => {
    if (theme === 'auto') {
      document.documentElement.removeAttribute('data-theme')
    } else {
      document.documentElement.setAttribute('data-theme', theme)
    }

    applyThemeToGiscus(theme)
  }

  const applyThemeToGiscus = (theme) => {
    theme = theme === 'auto' ? 'preferred_color_scheme' : theme

    const cmt = document.getElementById('giscus')
    if (cmt) {
      // This works before giscus load.
      cmt.setAttribute('data-theme', theme)
    }

    const iframe = document.querySelector('#comments > section.giscus > iframe')
    if (iframe) {
      // This works after giscus loaded.
      const src = iframe.src
      const newSrc = src.replace(/theme=[\w]+/, `theme=${theme}`)
      iframe.src = newSrc
    }
  }

  const switchTheme = () => {
    // light -> dark -> auto -> light -> ...
    const currentTheme = document.documentElement.getAttribute('data-theme')
    let newTheme;
    switch (currentTheme) {
      case 'light':
        newTheme = 'dark'
        break
      case 'dark':
        newTheme = 'auto'
        break
      default:
        newTheme = 'light'
    }
    applyTheme(newTheme)
    window.localStorage.setItem('Stellar.theme', newTheme)

    const messages = {
      light: `切换到浅色模式`,
      dark: `切换到深色模式`,
      auto: `切换到跟随系统配色`,
    }
    hud?.toast?.(messages[newTheme])
  }

  (() => {
    // Apply user's preferred theme, if any.
    const theme = window.localStorage.getItem('Stellar.theme')
    if (theme !== null) {
      applyTheme(theme)
    }
  })()
</script>


<!-- optional -->



<script defer>
  window.addEventListener('DOMContentLoaded', (event) => {
    ctx.services = Object.assign({}, JSON.parse(`{"mdrender":{"js":"/js/services/mdrender.js"},"siteinfo":{"js":"/js/services/siteinfo.js","api":null},"ghinfo":{"js":"/js/services/ghinfo.js"},"sites":{"js":"/js/services/sites.js"},"friends":{"js":"/js/services/friends.js"},"timeline":{"js":"/js/services/timeline.js"},"fcircle":{"js":"/js/services/fcircle.js"},"weibo":{"js":"/js/services/weibo.js"},"memos":{"js":"/js/services/memos.js"}}`));
    for (let id of Object.keys(ctx.services)) {
      const js = ctx.services[id].js;
      if (id == 'siteinfo') {
        ctx.cardlinks = document.querySelectorAll('a.link-card[cardlink]');
        if (ctx.cardlinks?.length > 0) {
          utils.js(js, { defer: true }).then(function () {
            setCardLink(ctx.cardlinks);
          });
        }
      } else {
        const els = document.getElementsByClassName(`ds-${id}`);
        if (els?.length > 0) {
          utils.jq(() => {
            if (id == 'timeline' || 'memos' || 'marked') {
              utils.js(deps.marked).then(function () {
                utils.js(js, { defer: true });
              });
            } else {
              utils.js(js, { defer: true });
            }
          });
        }
      }
    }
  });
</script>

<script>
  window.addEventListener('DOMContentLoaded', (event) => {
    ctx.search = {
      path: `/search.json`,
    }
    utils.js('/js/search/local-search.js', { defer: true });
  });
</script><script>
  window.FPConfig = {
    delay: 0,
    ignoreKeywords: [],
    maxRPS: 5,
    hoverDelay: 25
  };
</script>
<script defer src="https://cdn.jsdelivr.net/npm/flying-pages@2/flying-pages.min.js"></script><script defer src="https://cdn.jsdelivr.net/npm/vanilla-lazyload@19.1.3/dist/lazyload.min.js"></script>
<script>
  // https://www.npmjs.com/package/vanilla-lazyload
  // Set the options globally
  // to make LazyLoad self-initialize
  window.lazyLoadOptions = {
    elements_selector: ".lazy",
  };
  // Listen to the initialization event
  // and get the instance of LazyLoad
  window.addEventListener(
    "LazyLoad::Initialized",
    function (event) {
      window.lazyLoadInstance = event.detail.instance;
    },
    false
  );
  document.addEventListener('DOMContentLoaded', function () {
    window.lazyLoadInstance?.update();
  });
</script><script>
  ctx.fancybox = {
    selector: `.timenode p>img`,
    css: `https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0/dist/fancybox/fancybox.css`,
    js: `https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0/dist/fancybox/fancybox.umd.js`
  };
  var selector = '[data-fancybox]:not(.error)';
  if (ctx.fancybox.selector) {
    selector += `, ${ctx.fancybox.selector}`
  }
  var needFancybox = document.querySelectorAll(selector).length !== 0;
  if (!needFancybox) {
    const els = document.getElementsByClassName('ds-memos');
    if (els != undefined && els.length > 0) {
      needFancybox = true;
    }
  }
  if (needFancybox) {
    utils.css(ctx.fancybox.css);
    utils.js(ctx.fancybox.js, { defer: true }).then(function () {
      Fancybox.bind(selector, {
        hideScrollbar: false,
        Thumbs: {
          autoStart: false,
        },
        caption: (fancybox, slide) => {
          return slide.triggerEl.alt || slide.triggerEl.dataset.caption || null
        }
      });
    })
  }
</script>
<script>
  window.addEventListener('DOMContentLoaded', (event) => {
    const swiper_api = document.getElementById('swiper-api');
    if (swiper_api != undefined) {
      utils.css(`https://unpkg.com/swiper@10.3.1/swiper-bundle.min.css`);
      utils.js(`https://unpkg.com/swiper@10.3.1/swiper-bundle.min.js`, { defer: true }).then(function () {
        const effect = swiper_api.getAttribute('effect') || '';
        var swiper = new Swiper('.swiper#swiper-api', {
          slidesPerView: 'auto',
          spaceBetween: 8,
          centeredSlides: true,
          effect: effect,
          rewind: true,
          pagination: {
            el: '.swiper-pagination',
            clickable: true,
          },
          navigation: {
            nextEl: '.swiper-button-next',
            prevEl: '.swiper-button-prev',
          },
        });
      })
    }
  });
</script>
<script>
  document.addEventListener('DOMContentLoaded', function () {
    window.codeElements = document.querySelectorAll('.code');
    if (window.codeElements.length > 0) {
      ctx.copycode = {
        default_text: `Copy`,
        success_text: `Copied`,
        toast: `复制成功`,
      };
      utils.js('/js/plugins/copycode.js');
    }
  });
</script>


<!-- inject -->

</div></body></html>
